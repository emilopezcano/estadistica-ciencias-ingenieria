<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 11 Diseño de experimentos | Estadística Aplicada a las Ciencias y la Ingeniería</title>
<meta name="author" content="Emilio L. Cano">
<meta name="description" content="11.1 Introducción El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la herramienta más...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Capítulo 11 Diseño de experimentos | Estadística Aplicada a las Ciencias y la Ingeniería">
<meta property="og:type" content="book">
<meta property="og:url" content="https://emilopezcano.github.io/estadistica-ciencias-ingenieria/doe.html">
<meta property="og:image" content="https://emilopezcano.github.io/estadistica-ciencias-ingenieria/images/cover.png">
<meta property="og:description" content="11.1 Introducción El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la herramienta más...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 11 Diseño de experimentos | Estadística Aplicada a las Ciencias y la Ingeniería">
<meta name="twitter:description" content="11.1 Introducción El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la herramienta más...">
<meta name="twitter:image" content="https://emilopezcano.github.io/estadistica-ciencias-ingenieria/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Estadística Aplicada a las Ciencias y la Ingeniería</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenida</a></li>
<li class="book-part">Estadística descriptiva</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introducción</a></li>
<li><a class="" href="aed-uni.html"><span class="header-section-number">2</span> Análisis exploratorio univariante</a></li>
<li><a class="" href="aed-bi.html"><span class="header-section-number">3</span> Análisis exploratorio bivariante</a></li>
<li class="book-part">Probabilidad</li>
<li><a class="" href="introp.html"><span class="header-section-number">4</span> Introducción a la Probabilidad</a></li>
<li><a class="" href="vauni.html"><span class="header-section-number">5</span> Variable aleatoria univariante</a></li>
<li><a class="" href="vabi.html"><span class="header-section-number">6</span> Variable aleatoria bivariante</a></li>
<li><a class="" href="modelos.html"><span class="header-section-number">7</span> Modelos de distribución de probabilidad</a></li>
<li class="book-part">Inferencia estadística</li>
<li><a class="" href="muestreo.html"><span class="header-section-number">8</span> Muestreo y estimación</a></li>
<li><a class="" href="comparacion2.html"><span class="header-section-number">9</span> Comparación de dos grupos</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">10</span> Análisis de la Varianza</a></li>
<li><a class="active" href="doe.html"><span class="header-section-number">11</span> Diseño de experimentos</a></li>
<li><a class="" href="regresion.html"><span class="header-section-number">12</span> Modelos de regresión</a></li>
<li class="book-part">Control estadístico de la calidad</li>
<li><a class="" href="introc.html"><span class="header-section-number">13</span> Introducción</a></li>
<li><a class="" href="spc.html"><span class="header-section-number">14</span> Control Estadístico de Procesos</a></li>
<li><a class="" href="aceptacion.html"><span class="header-section-number">15</span> Inspección por muestreo</a></li>
<li class="book-part">Apéndices</li>
<li><a class="" href="s%C3%ADmbolos-abreviaturas-y-acr%C3%B3nimos.html"><span class="header-section-number">A</span> Símbolos, abreviaturas y acrónimos</a></li>
<li><a class="" href="formulario.html"><span class="header-section-number">B</span> Formulario</a></li>
<li><a class="" href="tablas.html"><span class="header-section-number">C</span> Tablas estadísticas</a></li>
<li><a class="" href="repaso.html"><span class="header-section-number">D</span> Repaso</a></li>
<li><a class="" href="ampliaci%C3%B3n.html"><span class="header-section-number">E</span> Ampliación</a></li>
<li><a class="" href="demostraciones.html"><span class="header-section-number">F</span> Demostraciones</a></li>
<li><a class="" href="creditos.html"><span class="header-section-number">G</span> Créditos</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/emilopezcano/estadistica-ciencias-ingenieria">Ver repositorio <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="doe" class="section level1" number="11">
<h1>
<span class="header-section-number">Capítulo 11</span> Diseño de experimentos<a class="anchor" aria-label="anchor" href="#doe"><i class="fas fa-link"></i></a>
</h1>
<div id="introducción-4" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-4"><i class="fas fa-link"></i></a>
</h2>
<p>El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier
otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la
herramienta más potente para la mejora, lo que ha llevado a algunos autores a
llamarlo “the jewel of quality engineering” (Ver por ejemplo
<span class="citation">Theodore T. Allen<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Introduction to Engineering Statistics and Lean Six Sigma - Statistical Quality Control and Design of Experiments and Systems&lt;/em&gt; (Springer, 2010).&lt;/p&gt;"><sup>88</sup></a></span>).</p>
<p>En apartados anteriores del libro hemos aprendido las herramientas básicas
para <strong>analizar la variabilidad</strong> de los datos. En este apartado vamos a revisar
las técnicas de Diseño de Experimentos y
su posterior análisis. Demasiado a menudo los esfuerzos se centran en intentar
analizar un experimento sin diseño, lo que provoca frustración en los equipos
involucrados en el análisis de datos. Vamos a mostrar la
importancia de la fase de diseño, así como su planificación y correcta
ejecución. No obstante la parte de análisis es igualmente importante, sobre todo en
lo que concierne a la correcta interpretación de los resultados.</p>
</div>
<div id="bases-del-doe-origen-importancia-objetivos-y-requerimientos" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Bases del DoE: origen, importancia, objetivos y requerimientos<a class="anchor" aria-label="anchor" href="#bases-del-doe-origen-importancia-objetivos-y-requerimientos"><i class="fas fa-link"></i></a>
</h2>
<p>El DoE moderno surge a principios del siglo XX de la mano de Ronald A. Fisher
cuando trabajaba en el “Rothamsted Experimental Station” en Inglaterra. Sus
estudios se centraban en reducir la variación natural y prevenir la confusión
con la variación de los restantes efectos. En última instancia, detectar
las relaciones causa-efecto con el menor esfuerzo experimental.</p>
<p>Básicamente, necesitamos el DoE frente a
estudios observacionales u otras estrategias como “un factor cada vez” para
estudiar las interacciones y encontrar relaciones de causa-efecto con
el menor uso de recursos posible.
Así, podremos tomar decisiones respaldadas por los datos.</p>
<p>El objetivo del diseño de experimentos es encontrar los niveles de
ciertos factores que optimizan una determinada característica medible.
Esto se consigue con un método sistemático<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;En realidad, el método científico.&lt;/p&gt;"><sup>89</sup></a> que evita salidas en falso y respuestas
incompletas. Mediante la reducción del error experimental se consigue evitar la confusión de los efectos y anular los efectos sin interés para el estudio.</p>
<p>Para empezar, lo primero que necesitamos es definir los datos del problema
objeto de estudio y disponer de una forma de obtenerlos adecuadamente, en particular:</p>
<ul>
<li>Una variable respuesta en escala métrica</li>
<li>Factores controlables</li>
<li>Posiblemente, otros factores aleatorios</li>
</ul>
<p>Esta recogida de datos se debe realizar de forma sistemática y
teniendo en cuenta los tres pilares del DoE: aleatorización, bloqueo y
replicación.</p>
</div>
<div id="importancia-del-diseño" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Importancia del diseño<a class="anchor" aria-label="anchor" href="#importancia-del-dise%C3%B1o"><i class="fas fa-link"></i></a>
</h2>
<p>Con la experimentación básicamente controlamos los niveles a los que operan
ciertos factores controlables, a la vez que se asignan dichos niveles
(configuraciones, tratamientos, etc.) a las unidades experimentales. Esto
permite, unido a las apropiadas estrategias de aleatorización, bloqueo y
replicación, realizar predicciones acerca del desempeño de un determinado
proceso. Estas predicciones así establecidas serán el resultado de la
identificación de una relación causa-efecto, que no se puede conseguir
simplemente analizando datos recogidos sin diseño. En los estudios observacionales:</p>
<ul>
<li>Recogemos información</li>
<li>No controlamos factores</li>
<li>Análisis descriptivos</li>
<li>Descubrir <em>relaciones</em>
</li>
</ul>
<p>Mientras que con experimentos diseñados:</p>
<ul>
<li>Se controlan los factores</li>
<li>Se analizan efectos</li>
<li>Incluidas las interacciones</li>
<li>Se verifica la relación <em>causa-efecto</em>
</li>
</ul>
<p>Si la experimentación se lleva a cabo variando una vez cada factor, buscando el
valor óptimo para la respuesta para cada factor individualmente dejando fijos
el resto arbitrariamente, estaremos obviando un aspecto
fundamental: el efecto de las interacciones. La interacción es el efecto que tiene un factor a distintos niveles de otros factores. Por otra parte, el número de
experimentos necesarios para llegar a conclusiones válidas es mucho mayor
(y por tanto el experimento más costoso). Con diseño de Experimentos obtenemos el mayor número de combinaciones posibles para estimar interacciones, con el mínimo número de experimentos.</p>
<div class="rmdcafe">
<p>El análisis de datos, por muy sofisticado que sea, no puede nunca
<em>arreglar</em> un experimento mal diseñado (chapucero, según Lawson)</p>
<blockquote>
<p>Sometimes the only thing you
can do with a poorly designed
experiment is to try to find out
what it died of<br>
R.A. Fisher</p>
</blockquote>
<blockquote>
<p>As we know from Murphy’s Law, if anything can go wrong it will, and analysis of
data can never compensate for botched experiments<br><span class="citation">Lawson<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Design and Analysis of Experiments with r&lt;/em&gt;.&lt;/p&gt;"><sup>90</sup></a></span></p>
</blockquote>
</div>
<p>El análisis de la varianza sin diseño de experimentos tiene algunas
limitaciones importantes. Sin Diseño de Experimentos, los datos pueden ser inconsistentes o incompletos, al no incluir factores de ruido o Factores latentes.
Si tenemos variables correlacionadas, y alguna de ellas no se
mide, su efecto puede quedar enmascarado por las otras, como en el ejemplo de la figura <a href="doe.html#fig:c1">11.1</a>, donde si miramos solo la relación de la variable respuesta
con el factor 1 (gráfico de la izquierda), podemos llegar a la conclusión
errónea de que el factor 1 es determinante. Pero podría ser que la causa real
sea el factor 2, que no ha sido medido y está muy correlacionado con el factor 1.
En el gráfico de la derecha vemos que la variable respuesta crece en el mismo sentido que los factores 1 y 2, pero podría ser que el factor 2, no medido al principio, sea la causa, y no el que realmente se ha medido.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:c1"></span>
<img src="11-doe_files/figure-html/c1-1.png" alt="Efecto de no medir un factor" width="672"><p class="caption">
Figura 11.1: Efecto de no medir un factor
</p>
</div>
<p>Por otra parte, el rango de valores de la variable respuesta está limitado por su
rango normal de operación, que puede ocultar relaciones más amplias. En la figura
<a href="doe.html#fig:valuesrange1">11.2</a>, el gráfico de la derecha se corresponde con el rango de
variación normal de
los factores de un proceso. En el de la izquierda, ampliamos el rango de
posibles valores de la variable, y vemos una relación más clara, que queda
oculta en el otro caso.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:valuesrange1"></span>
<img src="11-doe_files/figure-html/valuesrange1-1.png" alt="Efecto de la limitación del rango de valores" width="672"><p class="caption">
Figura 11.2: Efecto de la limitación del rango de valores
</p>
</div>
</div>
<div id="planificación-de-la-experimentación" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Planificación de la experimentación<a class="anchor" aria-label="anchor" href="#planificaci%C3%B3n-de-la-experimentaci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>El conocimiento de la materia (<em>subject matter knowledge</em>) en cuestión es fundamental para desarrollar
cambios que resulten en mejoras. Sin embargo, es
necesario otro tipo de conocimiento (<em>profound knowledge</em>), en el que se
incluye la Estadística. Combinar ambos conocimientos, lleva a una
mayor capacidad de mejora.
Estas ideas, originarias de Deming, se recogen en <span class="citation">R. Moen, T. Nolan, and L. Provost<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Quality Improvement Through Planned Experimentation 3/e&lt;/em&gt; (McGraw-Hill Education, 2012).&lt;/p&gt;"><sup>91</sup></a></span>.
Algunas capacidades necesarias fruto de esta combinación son:</p>
<ul>
<li>Entender las interdependencias entre los sistemas donde se lleva a cabo
la experimentación;</li>
<li>Entender la relación entre las predicciones y el conocimiento del
sistema que se quiere cambiar;</li>
<li>Entender el efecto temporal de los cambios;</li>
<li>Entender la importancia de la estabilidad del proceso;</li>
<li>Entender la extrapolación de los resultados de las pruebas para mejorar
el sistema.</li>
</ul>
<p>En general, se pueden seguir tres estrategias de planificación para el diseño de
experimentos. Sin planificación se pueden ir cambiando niveles de factores cada
vez y haciendo pruebas (ensayo-error), definitivamente poco efectivo. Una
planificación completa desde el inicio puede llevar a no explorar alternativas
surgidas durante la experimentación, y por tanto a no cumplir los objetivos. La
estrategia óptima la secuencia, es decir, llevar a cabo un número de experimentos al inicio, cuyas
conclusiones supondrán la planificación de una segunda fase donde centrarnos en
los factores realmente relevantes y hacer análisis más detallados y precisos. En las
primeras fases se suelen realizar diseños de <em>screening</em> para descartar
factores no significativos. En realidad, es la aplicación del método científico,
en un proceso iterativo de aprendizaje como se muestra en la figura <a href="doe.html#fig:metodo">11.3</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:metodo"></span>
<img src="11-doe_files/figure-html/metodo-1.png" alt="Método iterativo de aprendizaje" width="672"><p class="caption">
Figura 11.3: Método iterativo de aprendizaje
</p>
</div>
<p>En <span class="citation">Moen, Nolan, and Provost<a href="#fn92" class="footnote-ref" id="fnref92"><sup>92</sup></a></span> se propone el ciclo PDSA (<em>Plan-Do-Study-Act</em>) para la mejora que se muestra en la figura <a href="doe.html#fig:ciclo">11.4</a>. Básicamente consiste en:</p>
<ol style="list-style-type: decimal">
<li>Planifica un cambio o prueba, dirigido a la <strong>mejora</strong>
</li>
<li>Lleva a cabo el cambio o prueba (corto alcance)</li>
<li>Estudia el resultado: ¿qué has aprendido? ¿qué ha ido mal?</li>
<li>Actúa:
<ul>
<li>Adopta el cambio</li>
<li>Abandónalo</li>
<li>Empieza el ciclo de nuevo</li>
</ul>
</li>
</ol>
<p><strong>¡Documenta todas las acciones de mejora!</strong></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ciclo"></span>
<img src="11-doe_files/figure-html/ciclo-1.png" alt="Ciclo PDSA para la mejora" width="672"><p class="caption">
Figura 11.4: Ciclo PDSA para la mejora
</p>
</div>
<p>Una buena forma de empezar el ciclo es a partir de un análisis de causa y
efecto, por ejemplo con un diagrama de Ishikawa como el que aparece en la
figura <a href="doe.html#fig:cefecto">11.5</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cefecto"></span>
<img src="11-doe_files/figure-html/cefecto-1.png" alt="Ejemplo diagrama de causa-efecto" width="672"><p class="caption">
Figura 11.5: Ejemplo diagrama de causa-efecto
</p>
</div>
<p>Lo siguiente probablemente sería determinar el presupuesto/recursos disponibles,
en especial determinar el número de experimentos que se pueden realizar
realísticamente.</p>
<p>Hasta ahora, hemos ido mencionando algunos conceptos básicos del diseño de
experimentos. Ahora vamos a definirlos un poco más formalmente.</p>
<ul>
<li>
<strong>variable respuesta</strong>: La variable de interés que pretendemos
mejorar. Será una cuantificación de alguna característica de
calidad, en sentido amplio.</li>
<li>
<strong>factor</strong>: Variable independiente que puede ser causa de la respuesta.
La inferencia que haremos con DoE será confirmar o rechazar esta
hipótesis.</li>
<li>
<strong>variable de bloque</strong>: Variable que no tiene interés en la investigación,
pero puede influir en la respuesta. Mediante la formación de bloques
confundimos su efecto con los factores que realmente nos interesan.</li>
<li>
<strong>variable ruido</strong>: Variable que puede influir en la respuesta, pero de la
que no tenemos control.</li>
<li>
<strong>nivel</strong>: Valor que fijamos de un factor. En variables
cualitativas, una categoría. En variables cuantitativas, un valor numérico
determinado fijado con antelación.
A menudo se le llama también tratamiento.</li>
<li>
<strong>unidad experimental</strong>: La división más pequeña posible de unidades de un
experimento tal que a dos cualesquiera se les pueden aplicar distintas
combinaciones de factores y niveles.</li>
<li>
<strong>unidad observable</strong>: Cada uno de los elementos que forman la unidad
experimental. A veces, un tratamiento no se puede aplicar a un solo
elemento, sino a varios a la vez.</li>
<li>
<strong>bloque</strong>: Grupos de unidades experimentales que son tratados de forma
similar en el experimento.</li>
<li>
<strong>efecto</strong>: El principal resultado de interés del experimento: qué pasa con
la variable respuesta.</li>
<li>
<strong>réplica</strong>: Repetición de un experimento sobre una misma combinación de
factores y niveles, a diferentes unidades experimentales.</li>
<li>
<strong>repetición</strong>: Repetición de la medición de la respuesta con las mismas
condiciones experimentales, a la misma unidad experimental.</li>
<li>
<strong>aleatorización</strong>: Asignación de niveles y bloques a unidades
experimentales de forma aleatoria</li>
</ul>
<p>Al utilizar un modelo para simplificar una realidad, estamos cometiendo un
error. El <strong>error experimental</strong> es aquel que se debe exclusivamente a las réplicas
de las mismas condiciones experimentales. En cada diseño el error experimental
se calcula de una forma distinta, de forma que se separa de la variabilidad total
para ver cuánta variaación se debe al modelo y poder así tomar decisiones. Así, en el modelo:</p>
<p><span class="math display">\[Y = f(X) + \varepsilon\]</span></p>
<ul>
<li>Y es la variable respuesta</li>
<li>X es el conjunto de variables predictivas</li>
<li>
<span class="math inline">\(f\)</span> función lineal, exponencial, etc.</li>
<li>
<span class="math inline">\(\varepsilon\)</span> es una variable aleatoria</li>
</ul>
<p>Se separa el error de la variabilidad total.</p>
<p>Los siguientes principios son cruciales a la hora de diseñar el experimento.</p>
<ul>
<li><p><strong>Aleatorización</strong>. Los tratamientos deben ser asignados de forma aleatoria a las
unidades experimentales. Esto incluye bloques, factores controlables, anidamientos,
etc.</p></li>
<li><p><strong>Formación de bloques</strong>. Cuando no se puedan replicar exactamente las condiciones
experimentales (por ejemplo, días diferentes), se deben organizar en bloques.</p></li>
<li><p><strong>Réplicas</strong>. Para poder estimar el error experimental y hacer contrastes de
hipótesis, es necesario tener más de una <em>corrida</em> de cada combinación de tratamientos.</p></li>
</ul>
<p><span class="citation">Lawson<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Design and Analysis of Experiments with r&lt;/em&gt;.&lt;/p&gt;"><sup>93</sup></a></span> propone la siguiente <em>checklist</em> a la hora de planificar
experimentos:</p>
<ol style="list-style-type: decimal">
<li>Definir objetivos</li>
<li>Identificar unidades experimentales</li>
<li>Definir variable respuesta medible y con sentido</li>
<li>Identificar los factores controlables y latentes</li>
<li>Ejecutar pruebas piloto</li>
<li>Hacer diagrama de flujo para cada experimento</li>
<li>Elegir el diseño experimental</li>
<li>Determinar el número de réplicas necesarias</li>
<li>Aleatorizar las condiciones experimentales a las unidades experimentales</li>
<li>Definir método de análisis de datos</li>
<li>Calendario y presupuesto para la ejecución</li>
</ol>
</div>
<div id="tipos-de-diseños-de-experimentos" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Tipos de diseños de experimentos<a class="anchor" aria-label="anchor" href="#tipos-de-dise%C3%B1os-de-experimentos"><i class="fas fa-link"></i></a>
</h2>
<div id="experimentos-con-un-factor" class="section level3" number="11.5.1">
<h3>
<span class="header-section-number">11.5.1</span> Experimentos con un factor<a class="anchor" aria-label="anchor" href="#experimentos-con-un-factor"><i class="fas fa-link"></i></a>
</h3>
<p>Podemos comparar una variable a distintos niveles de un solo
factor. El contraste de la <span class="math inline">\(t\)</span> de Student es la técnica
utilizada para dos niveles. Para más niveles, utilizamos
el análisis de la varianza de un factor (véase sec:anova1).
Cuando hay algún factor más que no es de interés,
pero puede afectar a la variable resupesta, se debe introducir
como variable de bloque. Los diseños de cuadrados latinos
y cuadrados greco-latinos se utilizan para introducir dos o tres
factores de bloque respectivamente.</p>
<p>El diseño experimental para el ANOVA de un factor sigue las siguientes pautas:</p>
<ol style="list-style-type: decimal">
<li><p>Se quiere estudiar el efecto de un solo factor sobre una población. No hay otros
factores controlables que puedan influir.</p></li>
<li><p>Se realiza el plan de recogida de datos, posiblemente con prueba piloto.</p></li>
<li><p>Se decide el número de unidades experimentales del experimento.</p></li>
<li><p>Se asignan <strong>aleatoriamente</strong> las unidades a los niveles del factor.</p></li>
<li><p>Se recogen los datos (experimento físico, cuestionario, etc.)</p></li>
<li><p>Se realiza un análisis descriptivo, sobre todo gráfico, de los datos recogidos.</p></li>
<li><p>Los datos se verifican y se preparan adecuadamente para el análisis.</p></li>
<li><p>Se ajusta el modelo.</p></li>
<li><p>Se comprueba la validez del modelo. Si no es válido, se busca modelo alternativo de análisis.</p></li>
<li><p>Se estiman los parámetros.</p></li>
<li><p>Se comprueba las hipótesis principal.</p></li>
<li><p>Si hay diferencias, se realizan comparaciones por pares.</p></li>
<li><p>Se comprueba la significación práctica y se obtienen conclusiones o se toman
decisiones.</p></li>
</ol>
</div>
<div id="diseños-multifactoriales" class="section level3" number="11.5.2">
<h3>
<span class="header-section-number">11.5.2</span> Diseños multifactoriales<a class="anchor" aria-label="anchor" href="#dise%C3%B1os-multifactoriales"><i class="fas fa-link"></i></a>
</h3>
<p>Cuando analizamos más de un factor a varios niveles, aplicamos
lo explicado en el apartado <a href="anova.html#sec:anova2">10.3</a>. Recordemos que en
estos diseños es de vital importancia estudiar las interacciones.</p>
</div>
<div id="diseños-factoriales-a-dos-niveles-2k" class="section level3" number="11.5.3">
<h3>
<span class="header-section-number">11.5.3</span> Diseños factoriales a dos niveles <span class="math inline">\(2^k\)</span><a class="anchor" aria-label="anchor" href="#dise%C3%B1os-factoriales-a-dos-niveles-2k"><i class="fas fa-link"></i></a>
</h3>
<p>Un tipo especial de diseño multifactorial es aquél en el que
todos los factores tienen solamente dos niveles. El número
de experimentos necesarios para probar todas las combinaciones
de niveles para <span class="math inline">\(k\)</span> factores es <span class="math inline">\(2^k\)</span>, de ahi su nombre.</p>
<p><strong>Diseño factorial <span class="math inline">\(2^2\)</span></strong></p>
<p>Modelo:</p>
<p><span class="math display">\[y_{ijk} = \alpha_i + \beta_j + \alpha\beta_{ij} + \varepsilon_{ijk}\]</span></p>
<p>Datos:</p>
<ul>
<li>Aleatorizar tratamientos</li>
<li>Realizar <span class="math inline">\(k\)</span> réplicas</li>
<li>Número de experimentos: <span class="math inline">\(k\times 2^2\)</span>
</li>
</ul>
<p>Análisis:
- Efectos principales
- Interacción</p>
<div class="rmdpractica">
<p>En el siguiente código se analiza un experimento con dos factores A y B a dos niveles, <code>+</code> y + <code>-</code>. Se muestran los gráficos de los efectos.</p>
</div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://xtable.r-forge.r-project.org/">xtable</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://prof.beuth-hochschule.de/groemping/DoE/">DoE.base</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">effects</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="va">datosf22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"
-   -   28
-   -   25  
-   -   27
+   -   36
+   -   32
+   -   32
-   +   18
-   +   19
-   +   23
+   +   31
+   +   30
+   +   29  
"</span>, 
    what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
    sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span> 
<span class="va">datosf22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">datosf22</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">datosf22</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"respuesta"</span><span class="op">)</span>
<span class="va">datosf22</span><span class="op">$</span><span class="va">replica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html">dcast</a></span><span class="op">(</span><span class="va">datosf22</span>, <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">~</span> <span class="va">replica</span>, value.var <span class="op">=</span> <span class="st">"respuesta"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">A</th>
<th align="left">B</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">-</td>
<td align="left">-</td>
<td align="right">28</td>
<td align="right">25</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="left">-</td>
<td align="left">+</td>
<td align="right">18</td>
<td align="right">19</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">+</td>
<td align="left">-</td>
<td align="right">36</td>
<td align="right">32</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">+</td>
<td align="right">31</td>
<td align="right">30</td>
<td align="right">29</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modelof22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoE.base/man/lm.design.html">lm</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">datosf22</span><span class="op">)</span>
<span class="co"># kable(anova(modelof22))</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelof22</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: respuesta</span>
<span class="co">#&gt;           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; A          1 208.333 208.333 53.1915 8.444e-05 ***</span>
<span class="co">#&gt; B          1  75.000  75.000 19.1489  0.002362 ** </span>
<span class="co">#&gt; A:B        1   8.333   8.333  2.1277  0.182776    </span>
<span class="co">#&gt; Residuals  8  31.333   3.917                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">trellis.par.set</a></span><span class="op">(</span>background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"A"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; NOTE: A is not a high-order term in the model</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-2-1.png" width="672"></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"B"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; NOTE: B is not a high-order term in the model</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-3-1.png" width="672"></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"A:B"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<div class="rmdejemplo">
<p>Vemos que los dos efectos principales son significativos, pero no lo es la interacción. Podemos eliminar ese término del modelo para así ganar grados de libertad y tener una mejor estimación del error.</p>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modelof22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoE.base/man/lm.design.html">lm</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>, data <span class="op">=</span> <span class="va">datosf22</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelof22</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: respuesta</span>
<span class="co">#&gt;           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span>
<span class="co">#&gt; A          1 208.333 208.333  47.269 7.265e-05 ***</span>
<span class="co">#&gt; B          1  75.000  75.000  17.017  0.002578 ** </span>
<span class="co">#&gt; Residuals  9  39.667   4.407                      </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"A"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"B"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>
<p><strong>Diseño factorial <span class="math inline">\(2^3\)</span></strong></p>
<p>Modelo:</p>
<p><span class="math display">\[y_{ijkl} = \alpha_i + \beta_j + \gamma_k + \alpha\beta_{ij}
+ \alpha\gamma_{ik}+ \beta\gamma_{jk} + \alpha\beta\gamma_{ijk} + \varepsilon_{ijkl}\]</span></p>
<p>Datos:
- Aleatorizar tratamientos
- <span class="math inline">\(l\)</span> réplicas (o no)
- Número de experimentos: <span class="math inline">\(l\times 2^3\)</span></p>
<p>Análisis:</p>
<ul>
<li>Efectos principales</li>
<li>Interacciones (más de dos difícil de ver)</li>
<li>Eliminar no significativas para aumentar precisión</li>
</ul>
<div class="rmdejemplo">
<p>En el siguiente ejemplo, analizamos tres factores, pero omitimos la interacción de orden 3. Después, podríamos eliminar las interacciones menos significativas para quedarnos con el modelo más sencillo.</p>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datosf23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"
-   -   -   60
+   -   -   72  
-   +   -   54
+   +   -   68
-   -   +   52
+   -   +   83
-   +   +   45
+   +   +   80
"</span>, 
    what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
    sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span> 
<span class="va">datosf23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">datosf23</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">datosf23</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"C"</span>, <span class="st">"K"</span>, <span class="st">"rendimiento"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html">dcast</a></span><span class="op">(</span><span class="va">datosf23</span>, <span class="cn">T</span> <span class="op">+</span> <span class="va">C</span> <span class="op">+</span> <span class="va">K</span> <span class="op">~</span> <span class="va">.</span>, value.var <span class="op">=</span> <span class="st">"rendimiento"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">T</th>
<th align="left">C</th>
<th align="left">K</th>
<th align="right">.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="right">54</td>
</tr>
<tr class="even">
<td align="left">-</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="right">72</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="right">83</td>
</tr>
<tr class="odd">
<td align="left">+</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="right">80</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modelof23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DoE.base/man/lm.design.html">lm</a></span><span class="op">(</span><span class="va">rendimiento</span> <span class="op">~</span> <span class="cn">T</span> <span class="op">+</span> <span class="va">C</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="cn">T</span><span class="op">*</span><span class="va">C</span> <span class="op">+</span> <span class="cn">T</span><span class="op">*</span><span class="va">K</span> <span class="op">+</span> <span class="va">C</span><span class="op">*</span><span class="va">K</span>, data <span class="op">=</span> <span class="va">datosf23</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelof23</span><span class="op">)</span>
<span class="co">#&gt; Analysis of Variance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: rendimiento</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span>
<span class="co">#&gt; T          1 1058.0  1058.0    2116 0.01384 *</span>
<span class="co">#&gt; C          1   50.0    50.0     100 0.06345 .</span>
<span class="co">#&gt; K          1    4.5     4.5       9 0.20483  </span>
<span class="co">#&gt; T:C        1    4.5     4.5       9 0.20483  </span>
<span class="co">#&gt; T:K        1  200.0   200.0     400 0.03180 *</span>
<span class="co">#&gt; C:K        1    0.0     0.0       0 1.00000  </span>
<span class="co">#&gt; Residuals  1    0.5     0.5                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"T"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; NOTE: T is not a high-order term in the model</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"C"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; NOTE: C is not a high-order term in the model</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-9-2.png" width="672"></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"K"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; NOTE: K is not a high-order term in the model</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-9-3.png" width="672"></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"T:C"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-9-4.png" width="672"></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"T:K"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-9-5.png" width="672"></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"C:K"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-9-6.png" width="672"></div>
<p><strong>Diseño factorial <span class="math inline">\(2^k\)</span></strong></p>
<p>Siguiendo la misma estructura que los dos anteriores, con más efectos principales y más interacciones, pero más allá de 3 es muy difícil que se produzcan, y más difícil de interpretar.
El número de experimentos necesarios aumenta exponencialmente, y se suelen preferir experimentos fraccionados. Cuando no hay grados de libertad suficientes para realizar contrastes se utilizan herramientas gráficas para seleccionar efectos significativos (Pareto y gráfico normal)</p>
<p>Para la Formación de bloques, se confunden con efectos de interacciones de orden superior, multiplicando los signos y dividiendo en dos bloques</p>
</div>
<div id="diseños-fraccionales" class="section level3" number="11.5.4">
<h3>
<span class="header-section-number">11.5.4</span> Diseños fraccionales<a class="anchor" aria-label="anchor" href="#dise%C3%B1os-fraccionales"><i class="fas fa-link"></i></a>
</h3>
<p>Los diseños factoriales fraccionales <span class="math inline">\(2^{k-p}\)</span> utilizan solo una fracción de su equivalente factorial. En estos diseños se confunden los efectos principales con las interacciones de mayor orden. De esta forma, se puede realizar <em>screening</em> de muchos factores con pocos experimentos, y una vez eliminados del modelo los efectos no significativos se estima mejor el error.</p>
</div>
<div id="diseños-avanzados" class="section level3" number="11.5.5">
<h3>
<span class="header-section-number">11.5.5</span> Diseños avanzados<a class="anchor" aria-label="anchor" href="#dise%C3%B1os-avanzados"><i class="fas fa-link"></i></a>
</h3>
<p>Existen otros diseños avanzados que no se tratan en este texto, como son:</p>
<ul>
<li>Plackett and Burman</li>
<li>Diseños anidados</li>
<li>Split-plot</li>
<li>Medidas repetidas</li>
<li>Superficie respuesta</li>
</ul>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="anova.html"><span class="header-section-number">10</span> Análisis de la Varianza</a></div>
<div class="next"><a href="regresion.html"><span class="header-section-number">12</span> Modelos de regresión</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice capítulo"><h2>Índice capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#doe"><span class="header-section-number">11</span> Diseño de experimentos</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n-4"><span class="header-section-number">11.1</span> Introducción</a></li>
<li><a class="nav-link" href="#bases-del-doe-origen-importancia-objetivos-y-requerimientos"><span class="header-section-number">11.2</span> Bases del DoE: origen, importancia, objetivos y requerimientos</a></li>
<li><a class="nav-link" href="#importancia-del-dise%C3%B1o"><span class="header-section-number">11.3</span> Importancia del diseño</a></li>
<li><a class="nav-link" href="#planificaci%C3%B3n-de-la-experimentaci%C3%B3n"><span class="header-section-number">11.4</span> Planificación de la experimentación</a></li>
<li>
<a class="nav-link" href="#tipos-de-dise%C3%B1os-de-experimentos"><span class="header-section-number">11.5</span> Tipos de diseños de experimentos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#experimentos-con-un-factor"><span class="header-section-number">11.5.1</span> Experimentos con un factor</a></li>
<li><a class="nav-link" href="#dise%C3%B1os-multifactoriales"><span class="header-section-number">11.5.2</span> Diseños multifactoriales</a></li>
<li><a class="nav-link" href="#dise%C3%B1os-factoriales-a-dos-niveles-2k"><span class="header-section-number">11.5.3</span> Diseños factoriales a dos niveles \(2^k\)</a></li>
<li><a class="nav-link" href="#dise%C3%B1os-fraccionales"><span class="header-section-number">11.5.4</span> Diseños fraccionales</a></li>
<li><a class="nav-link" href="#dise%C3%B1os-avanzados"><span class="header-section-number">11.5.5</span> Diseños avanzados</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/emilopezcano/estadistica-ciencias-ingenieria/blob/master/11-doe.Rmd">Ver fuente <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/emilopezcano/estadistica-ciencias-ingenieria/edit/master/11-doe.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Estadística Aplicada a las Ciencias y la Ingeniería</strong>" escrito por <a href="http://emilio.lcano.com" class="text-light">Emilio L. Cano</a>. Generado por última vez el día 2022-05-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
