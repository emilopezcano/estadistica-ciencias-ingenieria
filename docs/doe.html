<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 11 Diseño de experimentos | Estadística Aplicada a las Ciencias y la Ingeniería</title>
<meta name="author" content="Emilio L. Cano">
<meta name="description" content="11.1 Introducción El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la herramienta más...">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="Capítulo 11 Diseño de experimentos | Estadística Aplicada a las Ciencias y la Ingeniería">
<meta property="og:type" content="book">
<meta property="og:url" content="https://emilopezcano.github.io/estadistica-ciencias-ingenieria/doe.html">
<meta property="og:image" content="https://emilopezcano.github.io/estadistica-ciencias-ingenieria/images/cover.png">
<meta property="og:description" content="11.1 Introducción El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la herramienta más...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 11 Diseño de experimentos | Estadística Aplicada a las Ciencias y la Ingeniería">
<meta name="twitter:description" content="11.1 Introducción El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la herramienta más...">
<meta name="twitter:image" content="https://emilopezcano.github.io/estadistica-ciencias-ingenieria/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.2/tabwid.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.9/grViz.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Estadística Aplicada a las Ciencias y la Ingeniería</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenida</a></li>
<li class="book-part">Estadística descriptiva</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introducción</a></li>
<li><a class="" href="aed-uni.html"><span class="header-section-number">2</span> Análisis exploratorio univariante</a></li>
<li><a class="" href="aed-bi.html"><span class="header-section-number">3</span> Análisis exploratorio bivariante</a></li>
<li class="book-part">Probabilidad</li>
<li><a class="" href="introp.html"><span class="header-section-number">4</span> Introducción a la Probabilidad</a></li>
<li><a class="" href="vauni.html"><span class="header-section-number">5</span> Variable aleatoria univariante</a></li>
<li><a class="" href="vabi.html"><span class="header-section-number">6</span> Variable aleatoria bivariante</a></li>
<li><a class="" href="modelos.html"><span class="header-section-number">7</span> Modelos de distribución de probabilidad</a></li>
<li class="book-part">Inferencia estadística</li>
<li><a class="" href="muestreo.html"><span class="header-section-number">8</span> Muestreo y estimación</a></li>
<li><a class="" href="comparacion2.html"><span class="header-section-number">9</span> Comparación de dos grupos</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">10</span> Análisis de la Varianza</a></li>
<li><a class="active" href="doe.html"><span class="header-section-number">11</span> Diseño de experimentos</a></li>
<li><a class="" href="regresion.html"><span class="header-section-number">12</span> Modelos de regresión</a></li>
<li class="book-part">Control estadístico de la calidad</li>
<li><a class="" href="introc.html"><span class="header-section-number">13</span> Introducción</a></li>
<li><a class="" href="spc.html"><span class="header-section-number">14</span> Control Estadístico de Procesos</a></li>
<li><a class="" href="aceptacion.html"><span class="header-section-number">15</span> Inspección por muestreo</a></li>
<li class="book-part">Apéndices</li>
<li><a class="" href="s%C3%ADmbolos-abreviaturas-y-acr%C3%B3nimos.html"><span class="header-section-number">A</span> Símbolos, abreviaturas y acrónimos</a></li>
<li><a class="" href="formulario.html"><span class="header-section-number">B</span> Formulario</a></li>
<li><a class="" href="tablas.html"><span class="header-section-number">C</span> Tablas estadísticas</a></li>
<li><a class="" href="repaso.html"><span class="header-section-number">D</span> Repaso</a></li>
<li><a class="" href="ampliaci%C3%B3n.html"><span class="header-section-number">E</span> Ampliación</a></li>
<li><a class="" href="demostraciones.html"><span class="header-section-number">F</span> Demostraciones</a></li>
<li><a class="" href="ampliaciones.html"><span class="header-section-number">G</span> Ampliaciones</a></li>
<li><a class="" href="creditos.html"><span class="header-section-number">H</span> Créditos</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/emilopezcano/estadistica-ciencias-ingenieria">Ver repositorio <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="doe" class="section level1" number="11">
<h1>
<span class="header-section-number">Capítulo 11</span> Diseño de experimentos<a class="anchor" aria-label="anchor" href="#doe"><i class="fas fa-link"></i></a>
</h1>
<div id="introducción-4" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-4"><i class="fas fa-link"></i></a>
</h2>
<p>El Diseño y Análisis de Experimentos (que abreviaremos como DoE), como cualquier
otra técnica estadística, se basa en el estudio de la variabilidad. DoE es la
herramienta más potente para la mejora, lo que ha llevado a algunos autores a
llamarlo “the jewel of quality engineering” (Ver por ejemplo
<span class="citation">Theodore T. Allen<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Introduction to Engineering Statistics and Lean Six Sigma - Statistical Quality Control and Design of Experiments and Systems&lt;/em&gt; (Springer, 2010).&lt;/p&gt;"><sup>90</sup></a></span>).</p>
<p>En capítulos anteriores del libro hemos aprendido las herramientas básicas
para <strong>analizar la variabilidad</strong> de los datos. En este capítulo vamos a revisar
las técnicas de Diseño de Experimentos y
su posterior análisis. Demasiado a menudo los esfuerzos se centran en intentar
analizar un experimento sin diseño, lo que provoca frustración en los equipos
involucrados en el análisis de datos. Vamos a mostrar la
importancia de la fase de diseño, así como su planificación y correcta
ejecución. No obstante la parte de análisis es igualmente importante, sobre todo en
lo que concierne a la correcta interpretación de los resultados y la toma de decisiones informada.</p>
<div class="rmdcafe">
<p>En su discurso presidencial ante el Primer Congreso Estadístico de la India, Sir Ronald Fisher (1890-1962) dijo:</p>
<blockquote>
<p><em>“To consult the statistician after an experiment is finished is often merely to ask him to conduct a post mortem examination. He can perhaps say what the experiment died of”</em>.</p>
</blockquote>
<p>O, dicho en otras palabras, cuando analizamos los datos del experimento sin haber participado en el diseño, lo más que podemos hacerle es la autopsia.</p>
</div>
</div>
<div id="bases-del-doe-origen-importancia-objetivos-y-requerimientos" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Bases del DoE: origen, importancia, objetivos y requerimientos<a class="anchor" aria-label="anchor" href="#bases-del-doe-origen-importancia-objetivos-y-requerimientos"><i class="fas fa-link"></i></a>
</h2>
<p>El DoE moderno surge a principios del siglo XX de la mano de Ronald A. Fisher
cuando trabajaba en el “Rothamsted Experimental Station” en Inglaterra. Sus
estudios se centraban en reducir la variación natural y prevenir la confusión
con la variación de los restantes efectos. En última instancia, detectar
las relaciones causa-efecto con el menor esfuerzo experimental.</p>
<p>Básicamente, necesitamos el DoE frente a
estudios observacionales u otras estrategias como “un factor cada vez” para
estudiar las interacciones y encontrar relaciones de causa-efecto con
el menor uso de recursos posible.
Así, podremos tomar decisiones respaldadas por los datos.</p>
<p>El objetivo del diseño de experimentos es encontrar los niveles de
ciertos factores que optimizan una determinada característica medible.
Esto se consigue con un método sistemático<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;En realidad, el método científico.&lt;/p&gt;"><sup>91</sup></a> que evita salidas en falso y respuestas
incompletas. Mediante la reducción del error experimental se consigue evitar la confusión de los efectos y anular los efectos sin interés para el estudio.</p>
<p>Para empezar, lo primero que necesitamos es definir los datos del problema
objeto de estudio y disponer de una forma de obtenerlos adecuadamente, en particular:</p>
<ul>
<li>Una variable respuesta en escala métrica.</li>
<li>Factores controlables.</li>
<li>Posiblemente, otros factores aleatorios.</li>
</ul>
<p>Esta recogida de datos se debe realizar de forma sistemática y
teniendo en cuenta los tres pilares del DoE: <strong>aleatorización</strong>, <strong>bloqueo</strong> y
<strong>replicación</strong>.</p>
</div>
<div id="doe.importancia" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Importancia del diseño<a class="anchor" aria-label="anchor" href="#doe.importancia"><i class="fas fa-link"></i></a>
</h2>
<p>Con la experimentación básicamente controlamos los niveles a los que operan
ciertos factores controlables, a la vez que se asignan dichos niveles
(configuraciones, tratamientos, etc.) a las unidades experimentales. Esto
permite, unido a las apropiadas estrategias de aleatorización, bloqueo y
replicación, realizar predicciones acerca del desempeño de un determinado
proceso. Estas predicciones así establecidas serán el resultado de la
identificación de una relación causa-efecto, que no se puede conseguir
simplemente analizando datos recogidos sin diseño. En los <strong>estudios observacionales</strong>:</p>
<ul>
<li>Recogemos información (o simplemente “está ahí”).</li>
<li>No controlamos factores.</li>
<li>Se realizan análisis descriptivos.</li>
<li>Se descubren <strong>relaciones</strong> mediante inferencia.</li>
</ul>
<p>Mientras que con <strong>experimentos diseñados</strong>:</p>
<ul>
<li>Se controlan los factores y su asignación a los elementos en estudio (sujetos, cosas, plantas, …)</li>
<li>Se analizan los efectos en la variable respuesta.</li>
<li>Se analizan las interacciones de los factores.</li>
<li>Se verifica la relación <strong>causa-efecto</strong>.</li>
</ul>
<p>Si la experimentación se lleva a cabo variando una vez cada factor, buscando el
valor óptimo para la respuesta para cada factor individualmente dejando fijos
el resto arbitrariamente, estaremos obviando un aspecto
fundamental: el efecto de las interacciones. La interacción es el efecto que tiene un factor a distintos niveles de otros factores.</p>
<p>Por otra parte, el número de
experimentos necesarios para llegar a conclusiones válidas es mucho mayor
(y por tanto el experimento más costoso). Mediante un experimento diseñado obtenemos el mayor número de combinaciones posibles para estimar interacciones, con el mínimo número de experimentos.</p>
<div class="rmdcafe">
<p>El análisis de datos, por muy sofisticado que sea, no puede nunca
<em>arreglar</em> un experimento mal diseñado (chapucero, según Lawson)</p>
<blockquote>
<p>As we know from Murphy’s Law, if anything can go wrong it will, and analysis of
data can never compensate for botched experiments<br><span class="citation">Lawson<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Design and Analysis of Experiments with r&lt;/em&gt;.&lt;/p&gt;"><sup>92</sup></a></span></p>
</blockquote>
</div>
<p>El análisis de la varianza (ver capítulo <a href="anova.html#anova">10</a>) sin diseño de experimentos tiene algunas
limitaciones importantes. Sin Diseño de Experimentos, los datos pueden ser inconsistentes o incompletos, al no incluir factores de ruido o Factores latentes.
Si tenemos variables correlacionadas, y alguna de ellas no se
mide, su efecto puede quedar enmascarado por las otras, como en el ejemplo de la figura <a href="doe.html#fig:c1">11.1</a>, donde si miramos solo la relación de la variable respuesta
con el factor 1 (gráfico de la izquierda), podemos llegar a la conclusión
errónea de que el factor 1 es determinante. Pero podría ser que la causa real
sea el factor 2, que no ha sido medido y está muy correlacionado con el factor 1.
En el gráfico de la derecha vemos que la variable respuesta crece en el mismo sentido que los factores 1 y 2, pero podría ser que el factor 2, no medido al principio, sea la causa, y no el que realmente se ha medido.</p>
<pre><code>#&gt; Warning: `qplot()` was deprecated in ggplot2 3.4.0.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:c1"></span>
<img src="11-doe_files/figure-html/c1-1.png" alt="Efecto de no medir un factor" width="100%"><p class="caption">
Figura 11.1: Efecto de no medir un factor
</p>
</div>
<p>Por otra parte, el rango de valores de la variable respuesta está limitado por su
rango normal de operación, que puede ocultar relaciones más amplias. En la figura
<a href="doe.html#fig:valuesrange1">11.2</a>, el gráfico de la izquierda se corresponde con el rango de
variación normal de
los factores de un proceso. En el de la derecha, ampliamos el rango de
posibles valores de la variable, y vemos algunos patrones que quedan
ocultos en el otro caso. Por ejemplo, en los valores inferiores la pendiente es más pronunciada, mientras que en los valores superiores parece que
se empieza a invertir la tendencia.</p>
<pre><code>#&gt; Warning: The following aesthetics were dropped during statistical
#&gt; transformation: colour
#&gt; ℹ This can happen when ggplot fails to infer the correct
#&gt;   grouping structure in the data.
#&gt; ℹ Did you forget to specify a `group` aesthetic or to
#&gt;   convert a numerical variable into a factor?</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:valuesrange1"></span>
<img src="11-doe_files/figure-html/valuesrange1-1.png" alt="Efecto de la limitación del rango de valores" width="100%"><p class="caption">
Figura 11.2: Efecto de la limitación del rango de valores
</p>
</div>
</div>
<div id="planificación-de-la-experimentación" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Planificación de la experimentación<a class="anchor" aria-label="anchor" href="#planificaci%C3%B3n-de-la-experimentaci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>El conocimiento de la materia en cuestión (<em>subject matter knowledge</em>) es fundamental para desarrollar
cambios que resulten en mejoras. Sin embargo, es
necesario otro tipo de conocimiento (<em>profound knowledge</em>), en el que se
incluye la Estadística. Combinar ambos conocimientos, lleva a una
mayor capacidad de mejora.
Estas ideas, originarias de Deming, se recogen en <span class="citation">R. Moen, T. Nolan, and L. Provost<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Quality Improvement Through Planned Experimentation 3/e&lt;/em&gt; (McGraw-Hill Education, 2012).&lt;/p&gt;"><sup>93</sup></a></span>.
Algunas capacidades necesarias fruto de esta combinación son:</p>
<ul>
<li>Entender las interdependencias entre los sistemas donde se lleva a cabo
la experimentación.</li>
<li>Entender la relación entre las predicciones y el conocimiento del
sistema que se quiere cambiar.</li>
<li>Entender el efecto temporal de los cambios.</li>
<li>Entender la importancia de la estabilidad del proceso.</li>
<li>Entender la extrapolación de los resultados de las pruebas para mejorar
el sistema.</li>
</ul>
<p>En general, se pueden seguir tres estrategias de planificación para el diseño de
experimentos:</p>
<ol style="list-style-type: decimal">
<li>Sin planificación. Se pueden ir cambiando niveles de factores cada
vez y haciendo pruebas (ensayo-error). Esto es definitivamente poco efectivo.</li>
<li>Planificación completa desde el inicio. Si es muy rígida, nos puede llevar a no explorar alternativas
que puedan surgir durante la experimentación. Y por tanto a no cumplir los objetivos.</li>
<li>Planificación <strong>secuencial</strong>. Esta es la
estrategia óptima. Se llevan a cabo un número de experimentos al inicio, cuyas
conclusiones supondrán la planificación de una segunda fase donde centrarnos en
los factores realmente relevantes y hacer análisis más detallados y precisos. En las
primeras fases se suelen realizar diseños de <em>screening</em> para descartar
factores no significativos. En las siguientes fases, se amplían los experimentos solo con los factores significativos.</li>
</ol>
<p>En realidad, esta estrategia secuencial es la aplicación del método científico,
en un proceso iterativo de aprendizaje como se muestra en la figura <a href="doe.html#fig:metodo">11.3</a>. El experimento partirá de un objetivo que planteará ciertas hipótesis. Por deducción, se diseña el experimento y se obtienen datos. Estos datos confirman o no las hipótesis mediante la inducción, y nos hace plantearnos nuevas hipótesis. Así, hasta llegar a la conclusión y/o decisión final.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:metodo"></span>
<img src="11-doe_files/figure-html/metodo-1.png" alt="Método iterativo de aprendizaje" width="672"><p class="caption">
Figura 11.3: Método iterativo de aprendizaje
</p>
</div>
<p>En <span class="citation">Moen, Nolan, and Provost<a href="#fn94" class="footnote-ref" id="fnref94"><sup>94</sup></a></span> se propone el ciclo PDSA (<em>Plan-Do-Study-Act</em>) para la mejora que se muestra en la figura <a href="doe.html#fig:ciclo">11.4</a>. Básicamente consiste en:</p>
<ol style="list-style-type: decimal">
<li>Planifica un cambio o prueba, dirigido a la <strong>mejora</strong>.</li>
<li>Lleva a cabo el cambio o prueba, preferiblemente de corto alcance.</li>
<li>Estudia el resultado: ¿qué has aprendido? ¿qué ha ido mal?</li>
<li>Actúa:
<ul>
<li>Adopta el cambio.</li>
<li>Abandónalo.</li>
<li>Empieza el ciclo de nuevo.</li>
</ul>
</li>
</ol>
<p>Una cuestión fundamental es la necesidad de <strong>documentar</strong> todas las acciones de mejora, así como las lecciones aprendidas durante el proceso.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ciclo"></span>
<img src="11-doe_files/figure-html/ciclo-1.png" alt="Ciclo PDSA para la mejora" width="672"><p class="caption">
Figura 11.4: Ciclo PDSA para la mejora
</p>
</div>
<p>Una buena forma de empezar el ciclo es a partir de un análisis de causa y
efecto, por ejemplo con un diagrama de Ishikawa o de espina de pescado (<em>fishbone</em>) como el que aparece en la
figura <a href="doe.html#fig:cefecto">11.5</a>. Con esta técnica se identifica cuál es la variable respuesta que queremos investigar (efecto, cabeza del pescado) y cuáles son los posibles factores que pueden estar relacionados, y de los que en última instancia queremos averiguar si son la causa del efecto (espinas).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cefecto"></span>
<img src="11-doe_files/figure-html/cefecto-1.png" alt="Ejemplo diagrama de causa-efecto" width="672"><p class="caption">
Figura 11.5: Ejemplo diagrama de causa-efecto
</p>
</div>
<p>Lo siguiente probablemente sería determinar el presupuesto/recursos disponibles,
en especial determinar el número de experimentos que se pueden realizar
realísticamente.</p>
<p>Hasta ahora, hemos ido mencionando algunos conceptos básicos del diseño de
experimentos. Ahora vamos a definirlos un poco más formalmente.</p>
<ul>
<li>
<strong>Variable respuesta</strong>: La variable de interés que pretendemos
optimizar o determinar sus causas. En el ámbito industrial, será una cuantificación de alguna característica de
calidad, en sentido amplio.</li>
<li>
<strong>Factor</strong>: Variable independiente que puede ser causa de la respuesta.
La inferencia que haremos con DoE será confirmar o rechazar esta
hipótesis, así como la cuantificación de este efecto.</li>
<li>
<strong>Variable de bloque</strong>: Variable que no tiene interés en la investigación,
pero puede influir en la respuesta. Mediante la formación de bloques
aleatorios confundimos su efecto con los factores que realmente nos interesan.</li>
<li>
<strong>Variable ruido</strong>: Variable que puede influir en la respuesta, pero de la
que no tenemos control.</li>
<li>
<strong>Nivel</strong>: Valor que fijamos de un factor. En variables
cualitativas, es una categoría. En variables cuantitativas, un valor numérico
determinado fijado con antelación.
A menudo se le llama también tratamiento, aunque cuando se estudia más de un factor sería más apropiado hablar de tratamiento como combinación de los niveles de los factores.</li>
<li>
<strong>Unidad experimental</strong>: La división más pequeña posible de unidades de un
experimento tal que a dos cualesquiera se les pueden aplicar distintas
combinaciones de factores y niveles.</li>
<li>
<strong>Unidad observable</strong>: Cada uno de los elementos que forman la unidad
experimental. A veces, un tratamiento no se puede aplicar a un solo
elemento, sino a varios a la vez.</li>
<li>
<strong>Bloque</strong>: Grupos de unidades experimentales que son tratados de forma
similar en el experimento.</li>
<li>
<strong>Efecto</strong>: El principal resultado de interés del experimento: qué pasa con
la variable respuesta para cada nivel de un factor o combinación de factores.</li>
<li>
<strong>Réplica</strong>: Repetición de un experimento sobre una misma combinación de
factores y niveles, a <strong>diferentes</strong> unidades experimentales.</li>
<li>
<strong>Repetición</strong>: Repetición de la medición de la respuesta con las mismas
condiciones experimentales, a <strong>la misma</strong> unidad experimental.</li>
<li>
<strong>Aleatorización</strong>: Asignación de niveles y bloques a unidades
experimentales de forma aleatoria.</li>
</ul>
<p>Al utilizar un modelo para simplificar la realidad, estamos cometiendo un
error. El <strong>error experimental</strong> es aquel que se debe exclusivamente a las réplicas
de las mismas condiciones experimentales. En cada diseño el error experimental
se calcula de una forma distinta, de forma que se separa de la variabilidad total
para ver cuánta variación se debe al modelo y poder así tomar decisiones. Así, en el modelo general:</p>
<p><span class="math display">\[Y = f(\mathbf{X}) + \varepsilon,\]</span></p>
<ul>
<li>
<span class="math inline">\(Y\)</span> es la variable respuesta.</li>
<li>
<span class="math inline">\(\mathbf{X}\)</span> es el conjunto de variables predictivas.</li>
<li>
<span class="math inline">\(f\)</span> es una función (lineal, exponencial, etc.)</li>
<li>
<span class="math inline">\(\varepsilon\)</span> es una variable aleatoria que recoge todo lo que no explica la función <span class="math inline">\(f\)</span> de la variable respuesta <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>Los siguientes principios son cruciales a la hora de diseñar el experimento.</p>
<ul>
<li><p><strong>Aleatorización</strong>. Los tratamientos deben ser asignados de forma aleatoria a las
unidades experimentales. Esto incluye bloques, factores controlables, anidamientos,
etc.</p></li>
<li><p><strong>Formación de bloques</strong>. Cuando no se puedan replicar exactamente las condiciones
experimentales (por ejemplo, días diferentes), se deben organizar en bloques.</p></li>
<li><p><strong>Réplicas</strong>. Para poder estimar el error experimental y hacer contrastes de
hipótesis, es necesario tener más de una <em>corrida</em> de cada combinación de tratamientos.</p></li>
</ul>
<p><span class="citation">Lawson<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Design and Analysis of Experiments with r&lt;/em&gt;.&lt;/p&gt;"><sup>95</sup></a></span> propone la siguiente <em>checklist</em> a la hora de planificar
experimentos:</p>
<ol style="list-style-type: decimal">
<li>Definir objetivos.</li>
<li>Identificar unidades experimentales.</li>
<li>Definir variable respuesta medible y con sentido.</li>
<li>Identificar los factores controlables y latentes.</li>
<li>Ejecutar pruebas piloto.</li>
<li>Hacer diagrama de flujo para cada experimento.</li>
<li>Elegir el <strong>diseño experimental</strong>. Esta parte es crucial.</li>
<li>Determinar el número de réplicas necesarias.</li>
<li>Aleatorizar las condiciones experimentales a las unidades experimentales.</li>
<li>Definir método de análisis de datos.</li>
<li>Calendario y presupuesto para la ejecución.</li>
</ol>
<p>Es aconsejable recoger toda esta información en un formulario estandarizado que forme parte de la documentación del experimento o proyecto de mejora.</p>
</div>
<div id="tipos-de-diseños-de-experimentos" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Tipos de diseños de experimentos<a class="anchor" aria-label="anchor" href="#tipos-de-dise%C3%B1os-de-experimentos"><i class="fas fa-link"></i></a>
</h2>
<p>Existen una enorme cantidad de posibles tipos de diseños experimentales. La decisión sobre cuál utilizar en cada situación concreta depende principalmente de los objetivos de la investigación y de las características de las unidades experimentales (de ahí la importancia de caracterizarlas de forma precisa durante el diseño). La figura <a href="doe.html#fig:tiposdisenos">11.6</a> muestra la categorización que hace <span class="citation">Lawson<a href="#fn96" class="footnote-ref" id="fnref96"><sup>96</sup></a></span>. A continuación se enumeran estos diseños con una breve explicación de cada uno.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tiposdisenos"></span>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-29e925102d01db730e25" style="width:100%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-29e925102d01db730e25">{"x":{"diagram":"\ndigraph one_factor{\n  graph [layout=dot, rankdir = TB, compound = true, fontsize = 10, color = crimson]\n  node [shape = box]\n  \"Propósito\ndel diseño\"; \"RSE\"; LSD;RCD  \"RCB\";  \"GCB\"; \"PBIB,PTIB\"; \"BIB\"; \"Tamaño de bloque\" ;\"FRSE\nNSE\nSNSE\"; \"CRFD\nCRFF\nPB,OA\"; CRRS; \"SLD\nSCD\nEVD\"; RCBF; RBSP; \"CRSP\nSPFF\"; \"RSSP\nEESPRS\"; SPMPV; BRS; PCBF; CCBF\n  \n  node [shape = diamond]\n  \"Unidades experimentales\"\n  \"Factores de bloque\"\n  \n  \n  \"Unidades experimentales\" -> \"Factores de bloque\" [label = \"Heterogéneos\"] \n  \"Unidades experimentales\" -> \"CRD\" [label = \"Homogéneos\"] \n  \"Factores de bloque\" -> \"Tamaño de bloque\" [label = \"Uno\"] \n  \"Factores de bloque\" -> \"LSD\" [label = \"Dos\"] \n  LSD -> RCD\n  \"Tamaño de bloque\" -> \"RCB\" [label = \"Grande\"] \n  \"Tamaño de bloque\" -> \"PBIB,PTIB\" [label = \"Pequeño\"] \n  \"Propósito\ndel diseño\" -> RSE [label = \"Estudiar varianzas\"] \n  RCB -> GCB\n  \n    \"Propósito\ndel diseño\" -> \"Unidades experimentales\" [label = \"Estimar efectos\nde los factores\"] \n\n  \n  \n  subgraph cluster0{\n    label = \"Un factor\";\n    RSE\n    CRD\n    LSD\n    RCD\n    RCB\n    GCB\n    \"PBIB,PTIB\"\n    \"BIB\"\n  }\n  RSE -> \"FRSE\nNSE\nSNSE\"\n  \n  subgraph cluster1{\n  label = \"Varios factores\";\n    \"FRSE\nNSE\nSNSE\"\n        CRD -> \"Tipo factor\"\n    \"Tipo factor\" -> \"CRFD\nCRFF\nPB,OA\" [label = \"Categórico\"]\n    \"Tipo factor\" -> CRRS [label = \"Continuo\"]\n    \"Tipo factor\" -> \"SLD\nSCD\nEVD\" [label = \"Mezcla\"]\n    GCB -> RCBF\n    \"PBIB,PTIB\" -> \"BIB\"\n    BIB -> Factores\n    Factores -> BRS [label = \"Continuos\"]\n    Factores -> PCBF [label = \"Categóricos\"]\n    PCBF -> CCBF\n  } \n  subgraph cluster2{\n  label = \"Varios factores (algunos difícil de variar)\";\n    RCBF -> RBSP\n    \"CRFD\nCRFF\nPB,OA\" -> \"CRSP\nSPFF\"\n    \"CRRS\" -> \"RSSP\nEESPRS\"\n    \"SLD\nSCD\nEVD\" -> SPMPV\n    \n  } \n}  \n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figura 11.6: Esquema de diseños experimentales en Lawson (2015)
</p>
</div>
<ul>
<li><p><strong>CRD</strong>, <em>Completely Randomized Design</em>: <strong>Diseño completamente aleatorizado</strong>. Este diseño se debería utilizar cuando solo hay un factor en estudio y las unidades experimentales son homogéneas. El análisis se corresponde con el ANOVA estudiado en el capítulo <a href="anova.html#anova">10</a>.</p></li>
<li><p><strong>CRFD</strong>, <em>Completely Randomized Factorial Design</em>: <strong>Diseño factorial completamente aleatorizado</strong>. Este diseño se utiliza cuando se estudia más de un factor a la vez. Permite estudiar las interacciones entre los factores. El análisis se corresponde también con el ANOVA estudiado en el capítulo <a href="anova.html#anova">10</a>. Un caso particular son los diseños a dos niveles o <span class="math inline">\(2^k\)</span>, que veremos en detalle más adelante.</p></li>
<li><p><strong>CRRS</strong>, <em>Completely Randomized Response Surface</em>: <strong>Superficie respuesta completamente aleatorizado</strong>. Este diseño se utiliza cuando se estudian dos o tres factores continuos en los que puede aparecer curvatura y por tanto los valores que optimizan la respuesta pueden no estar en el perímetro de la región de diseño. Se suelen aplicar en la fase de caracterización de un experimento, después de haber seleccionado en la fase de cribado los factores más significativos.</p></li>
</ul>
</div>
<div id="experimentos-con-un-factor-crd" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> Experimentos con un factor (CRD)<a class="anchor" aria-label="anchor" href="#experimentos-con-un-factor-crd"><i class="fas fa-link"></i></a>
</h2>
<p>Podemos comparar una variable a distintos niveles de un solo
factor. El contraste de la <span class="math inline">\(t\)</span> de Student es la técnica
utilizada para dos niveles. Para más niveles, utilizamos
el análisis de la varianza de un factor (véase el capítulo <a href="anova.html#anova">10</a>.</p>
<p>El diseño experimental para el ANOVA de un factor sigue las siguientes pautas:</p>
<ol style="list-style-type: decimal">
<li><p>Se quiere estudiar el efecto de un solo factor sobre una población. No hay otros
factores controlables que puedan influir.</p></li>
<li><p>Se realiza el plan de recogida de datos, posiblemente con prueba piloto.</p></li>
<li><p>Se decide el número de unidades experimentales del experimento.</p></li>
<li><p>Se asignan <strong>aleatoriamente</strong> las unidades a los niveles del factor.</p></li>
<li><p>Se recogen los datos (experimento físico, cuestionario, etc.)</p></li>
<li><p>Se realiza un análisis descriptivo, sobre todo gráfico, de los datos recogidos.</p></li>
<li><p>Los datos se verifican y se preparan adecuadamente para el análisis.</p></li>
<li><p>Se ajusta el modelo.</p></li>
<li><p>Se comprueba la validez del modelo. Si no es válido, se busca modelo alternativo de análisis.</p></li>
<li><p>Se estiman los parámetros.</p></li>
<li><p>Se comprueba la hipótesis principal.</p></li>
<li><p>Si hay diferencias, se realizan comparaciones por pares.</p></li>
<li><p>Se comprueba la significación práctica y se obtienen conclusiones o se toman
decisiones.</p></li>
</ol>
</div>
<div id="diseños-factoriales-crfd" class="section level2" number="11.7">
<h2>
<span class="header-section-number">11.7</span> Diseños factoriales (CRFD)<a class="anchor" aria-label="anchor" href="#dise%C3%B1os-factoriales-crfd"><i class="fas fa-link"></i></a>
</h2>
<p>Cuando analizamos más de un factor a varios niveles,
el número total de unidades experimentales necesarias para tener una ejecución completa del experimento será <span class="math inline">\(n_1\times n_2, \cdots, n_k\)</span>,
donde <span class="math inline">\(n_i\)</span> es el número de niveles del factor <span class="math inline">\(i\)</span>, y el número total de factores es <span class="math inline">\(k\)</span>. Para tener dos réplicas completas del experimento necesitaremos el doble, y así sucesivamente.</p>
<p>Para el análisis de diseños equilibrados, aplicamos
lo explicado en el apartado <a href="anova.html#sec:anova2">10.3</a> para el ANOVA de dos factores con interacción. Recordemos que en
estos diseños es de vital importancia estudiar las interacciones.
El modelo se extiende inmediatamente a más de dos factores, en los
que las interacciones pueden ser dos a dos, tres a tres, etc. No obstante,
las interacciones de orden superior a 3 rara vez son significativas y se suelen descartar casi siempre.</p>
<p>A veces no es posible tener diseños equilibrados, es decir, con el mismo
número de réplicas en cada “celda” o cruce de niveles de factores. En estos casos, para hacer los contrastes correctos debemos utilizar la función <code><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova()</a></code> del paquete {car},<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;John Fox, Sanford Weisberg, and Brad Price, &lt;em&gt;Car: Companion to Applied Regression&lt;/em&gt;, 2022, &lt;a href="https://CRAN.R-project.org/package=car"&gt;https://CRAN.R-project.org/package=car&lt;/a&gt;.&lt;/p&gt;'><sup>97</sup></a></span> que calcula las sumas de cuadrados tipo II y tipo III, y los contrastes correctos. Las sumas de cuadrados del diseño equilibrado se suele llamar tipo I. Véase <span class="citation">Lawson<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Design and Analysis of Experiments with r&lt;/em&gt;.&lt;/p&gt;"><sup>98</sup></a></span> para una explicación más detallada, o la entrada “Diferentes sumas de cuadrados en ANOVA” de “El blog de los herreros”<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://erre-que-erre-paco.blogspot.com/2016/12/diferentes-sumas-de-cuadrados-en-anova.html" class="uri"&gt;https://erre-que-erre-paco.blogspot.com/2016/12/diferentes-sumas-de-cuadrados-en-anova.html&lt;/a&gt;&lt;/p&gt;'><sup>99</sup></a>.</p>
<div class="rmdejemplo">
<p>A modo ilustrativo, el siguiente código genera aleatoriamente datos de un supuesto experimento con tres factores: A (con niveles A1, A2 y A3), B (con niveles B1, B2 y B3) y C (con niveles C1 y C2). Las tablas ANOVA del diseño equilibrado son idénticas para los dos métodos. Pero si quitamos uno de los datos (puede ser una situación realista en un experimento tener un valor perdido), entonces las sumas de cuadrados con los distintos métodos no son iguales, y podrían llevar a decisiones distintas.</p>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: carData</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'car'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     recode</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     some</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">666</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">noeq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, B <span class="op">=</span> <span class="va">B</span>, C <span class="op">=</span> <span class="va">C</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  respuesta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="fl">18</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>respuesta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">C</span> <span class="op">==</span> <span class="st">"C2"</span>, </span>
<span>                                   <span class="va">respuesta</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">54</span>, <span class="fl">8</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                                   <span class="va">respuesta</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">noeq</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; A            2    148    73.8   0.576 0.5658  </span></span>
<span><span class="co">#&gt; B            2    314   157.1   1.227 0.3023  </span></span>
<span><span class="co">#&gt; C            1    791   791.2   6.175 0.0165 *</span></span>
<span><span class="co">#&gt; Residuals   48   6150   128.1                 </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="va">noeq</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: respuesta</span></span>
<span><span class="co">#&gt;           Sum Sq Df F value  Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; A          147.7  2  0.5762 0.56585  </span></span>
<span><span class="co">#&gt; B          314.3  2  1.2265 0.30233  </span></span>
<span><span class="co">#&gt; C          791.2  1  6.1755 0.01649 *</span></span>
<span><span class="co">#&gt; Residuals 6149.8 48                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="va">noeq</span><span class="op">$</span><span class="va">respuesta</span><span class="op">[</span><span class="fl">54</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="va">noeq</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; A            2    149    74.3   0.568 0.5704  </span></span>
<span><span class="co">#&gt; B            2    322   160.8   1.229 0.3018  </span></span>
<span><span class="co">#&gt; C            1    783   783.2   5.986 0.0182 *</span></span>
<span><span class="co">#&gt; Residuals   47   6149   130.8                 </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; 1 observation deleted due to missingness</span></span>
<span><span class="va">noeq</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: respuesta</span></span>
<span><span class="co">#&gt;           Sum Sq Df F value  Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; A          137.8  2  0.5267 0.59398  </span></span>
<span><span class="co">#&gt; B          308.5  2  1.1791 0.31648  </span></span>
<span><span class="co">#&gt; C          783.2  1  5.9863 0.01821 *</span></span>
<span><span class="co">#&gt; Residuals 6148.7 47                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>A medida que aumenta el número de factores a estudiar, el número de unidades experimentales a utilizar puede hacerse enorme, sobre todo si tenemos más de dos niveles. Para poder analizar un número grande de factores a modo de <em>screening</em> o cribado, se utiliza a menudo un tipo especial de diseños factoriales con solo dos niveles por cada factor, que veremos a continuación por separado dada su importancia.</p>
</div>
<div id="diseños-factoriales-a-dos-niveles-2k" class="section level2" number="11.8">
<h2>
<span class="header-section-number">11.8</span> Diseños factoriales a dos niveles <span class="math inline">\(2^k\)</span><a class="anchor" aria-label="anchor" href="#dise%C3%B1os-factoriales-a-dos-niveles-2k"><i class="fas fa-link"></i></a>
</h2>
<p>Un tipo especial de diseño factorial es aquél en el que
todos los factores tienen solamente dos niveles. Es válido tanto para factores puramente categóricos como para factores de tipo continuo. En este último caso, se fijan un valor “bajo” y otro “alto” para el factor, que normalmente se representan como <code>-</code> y <code>+</code> respectivamente.
Con posterioridad a la etapa de cribado se pueden añadir más puntos al diseño para afinar en la estimación.
En el caso de atributos, estos niveles alto y bajo serán arbitrarios, pero
en cualquiera de los dos casos, se deberían fijar de acuerdo al conocimiento en la materia para que haya una diferencia potencial entre los niveles.</p>
<p>El número
de experimentos necesarios para probar todas las combinaciones
de niveles para <span class="math inline">\(k\)</span> factores es <span class="math inline">\(2^k\)</span>, de ahí su nombre. Por ejemplo,
en un experimento en el que quisiéramos analizar 5 factores con 4 niveles cada uno, necesitaríamos <span class="math inline">\(4\times 4\times 4\times 4\times 4=4^5= 1024\)</span> unidades experimentales, para cada réplica, mientras que en un experimento
<span class="math inline">\(2^5\)</span> serán suficientes 32.</p>
<p>La popularidad de los diseños <span class="math inline">\(2^k\)</span> se debe, entre otras, a las siguientes
causas:</p>
<ul>
<li>Como acabamos de ver, con pocas observaciones se pueden analizar muchos factores. Esto nos será muy útil en las fases iniciales para descartar factores que no tienen ningún efecto en la respuesta.</li>
<li>Son fáciles de utilizar y el análisis se puede realizar con métodos gráficos.</li>
<li>Estos diseños han demostrado funcionar muy bien con sistemas complejos e incluso no lineales a través del estudio de las interacciones.</li>
<li>Se pueden analizar incluso más factores utilizando diseños fraccionales.</li>
</ul>
<p>Los datos de los experimentos factoriales <span class="math inline">\(2^k\)</span> se pueden representar de forma exhaustiva con la llamada “matriz de diseño” o en forma de tablas. La forma estándar de la matriz de diseño contiene en la primera columna signos alternos <code>-</code> y <code>+</code>. En la siguiente columna se alternarán dos signos <code>-</code> y dos signos <code>+</code>, y así sucesivamente hasta la última columna con el último factor, que tendrá la primera mitad de signos <code>-</code> y la otra mitad de signos <code>+</code>. En la matriz de diseño se identifica el orden estándar, pero las observaciones <strong>nunca</strong> se recogerán en el orden de la matriz de diseño. A cada unidad experimental se le asignará una de las combinaciones <strong>aleatoriamente</strong>. Esto se puede hacer con medios mecánicos o con generación de números pseudoaleatorios con el ordenador. En la propia tabla se puede incorporar un identificador de unidad experimental convenientemente aleatorizado. Una vez recogidos los datos, estos se pueden añadir a la tabla, bien cada uno de los datos de las réplicas, o resumidos con la media.</p>
<p>La tabla <a href="doe.html#tab:matrizest">11.1</a> muestra una tabla con todos los datos de un hipotético experimento con tres factores sin réplicas, creado con el siguiente código. Se fija la semilla aleatoria para garantizar la reproducibilidad.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">B</span> <span class="op">&lt;-</span> <span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"+"</span><span class="op">)</span></span>
<span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, B <span class="op">=</span> <span class="va">B</span>, C <span class="op">=</span> <span class="va">C</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`Unidad experimental (aleatoria)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>         `Respuesta (simulación)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"Orden estándar"</span><span class="op">)</span> </span>
<span><span class="va">dm</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_caption.html">set_caption</a></span><span class="op">(</span><span class="st">"Ejemplo de matriz de diseño y datos sin réplicas"</span><span class="op">)</span></span></code></pre></div>
<template id="e27d1ccf-2493-4c27-b03d-dea0246e1101"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td, .tabwid th {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-22d879d6{}.cl-22cf656c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-22d34268{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-22d3427c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-22d35bcc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22d35bd6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22d35be0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22d35be1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22d35be2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-22d35be3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<div class="inline-table"><table data-quarto-disable-processing="true" class="cl-22d879d6">
<caption>
<span id="tab:matrizest">Tabla 11.1: </span><span>Ejemplo de matriz de diseño y datos sin réplicas</span>
</caption>

<thead><tr style="overflow-wrap:break-word;">
<th class="cl-22d35bcc"><p class="cl-22d34268"><span class="cl-22cf656c">Orden estándar</span></p></th>
<th class="cl-22d35bcc"><p class="cl-22d34268"><span class="cl-22cf656c">A</span></p></th>
<th class="cl-22d35bcc"><p class="cl-22d34268"><span class="cl-22cf656c">B</span></p></th>
<th class="cl-22d35bcc"><p class="cl-22d34268"><span class="cl-22cf656c">C</span></p></th>
<th class="cl-22d35bd6"><p class="cl-22d3427c"><span class="cl-22cf656c">Unidad experimental (aleatoria)</span></p></th>
<th class="cl-22d35bd6"><p class="cl-22d3427c"><span class="cl-22cf656c">Respuesta (simulación)</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">1</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">1</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">6.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">2</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">4</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">8.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">3</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">8</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">9.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">4</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">2</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">10.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">5</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">6</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">14.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">6</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">3</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">11.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">7</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">-</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be0"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">7</span></p></td>
<td class="cl-22d35be1"><p class="cl-22d3427c"><span class="cl-22cf656c">8.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-22d35be2"><p class="cl-22d34268"><span class="cl-22cf656c">8</span></p></td>
<td class="cl-22d35be2"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be2"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be2"><p class="cl-22d34268"><span class="cl-22cf656c">+</span></p></td>
<td class="cl-22d35be3"><p class="cl-22d3427c"><span class="cl-22cf656c">5</span></p></td>
<td class="cl-22d35be3"><p class="cl-22d3427c"><span class="cl-22cf656c">7.7</span></p></td>
</tr>
</tbody>
</table></div>
</div></template><div class="flextable-shadow-host" id="6e6d903d-056e-4eef-a837-2a26c00e586d"></div>
<script>
var dest = document.getElementById("6e6d903d-056e-4eef-a837-2a26c00e586d");
var template = document.getElementById("e27d1ccf-2493-4c27-b03d-dea0246e1101");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><p>La información de la tabla completa se puede compactar poniendo los factores en filas y columnas y los datos en las celdas con los cruces. También es habitual encontrar la representación geométrica en forma de cuadrados (2 factores), cubos (3 factores) o hipercubos (más de 3 factores). Se pueden ver algunos ejemplos en <span class="citation">Lawson<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Design and Analysis of Experiments with r&lt;/em&gt;.&lt;/p&gt;"><sup>100</sup></a></span> y <span class="citation">Moen, Nolan, and Provost<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Quality Improvement Through Planned Experimentation 3/e&lt;/em&gt;.&lt;/p&gt;"><sup>101</sup></a></span>.</p>
<p>Por la naturaleza dicotómica de los factores, la estimación de los factores es muy sencilla, resultando además que:</p>
<p><span class="math display">\[\alpha_1 = -\alpha_2;\; \beta_1=-\beta_2.\]</span></p>
<div id="diseño-factorial-22" class="section level3" number="11.8.1">
<h3>
<span class="header-section-number">11.8.1</span> Diseño factorial <span class="math inline">\(2^2\)</span><a class="anchor" aria-label="anchor" href="#dise%C3%B1o-factorial-22"><i class="fas fa-link"></i></a>
</h3>
<p>Es el diseño más sencillo que podemos hacer, y solo necesitamos <span class="math inline">\(2^2=4\)</span> unidades experimentales para cada réplica del experimento.</p>
<p>El modelo matemático sería el siguiente:</p>
<p><span class="math display">\[y_{ijk} = \mu +
\alpha_i + \beta_j + \alpha\beta_{ij} + \varepsilon_{ijk},\]</span></p>
<p>donde <span class="math inline">\(i, j\)</span> toman dos valores, <span class="math inline">\(\{-, +\}\)</span>, y <span class="math inline">\(k\)</span> representa las réplicas del experimento, <span class="math inline">\(k = 1, \ldots, n\)</span>. Así, el número total de unidades experimentales es <span class="math inline">\(n\times 2^2\)</span>. Si solo tenemos una réplica <span class="math inline">\((n=1)\)</span>, entonces podremos estimar los efectos pero no podremos hacer contrastes de hipótesis sobre su significatividad.</p>
<div class="rmdpractica">
<p>En el siguiente código se analiza un experimento con dos factores A y B a dos niveles, <code>+</code> y + <code>-</code>. Se muestran los gráficos de los efectos.</p>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">effects</a></span><span class="op">)</span></span>
<span><span class="va">datosf22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">-   -   28</span></span>
<span><span class="st">-   -   25  </span></span>
<span><span class="st">-   -   27</span></span>
<span><span class="st">+   -   36</span></span>
<span><span class="st">+   -   32</span></span>
<span><span class="st">+   -   32</span></span>
<span><span class="st">-   +   18</span></span>
<span><span class="st">-   +   19</span></span>
<span><span class="st">-   +   23</span></span>
<span><span class="st">+   +   31</span></span>
<span><span class="st">+   +   30</span></span>
<span><span class="st">+   +   29  </span></span>
<span><span class="st">"</span>, </span>
<span>    what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span> </span>
<span><span class="va">datosf22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">datosf22</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">datosf22</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"respuesta"</span><span class="op">)</span></span>
<span><span class="va">datosf22</span><span class="op">$</span><span class="va">replica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">datosf22</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, </span>
<span>              names_from <span class="op">=</span> <span class="st">"replica"</span>, </span>
<span>              values_from <span class="op">=</span> <span class="st">"respuesta"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">A</th>
<th align="left">B</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">-</td>
<td align="left">-</td>
<td align="right">28</td>
<td align="right">25</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">-</td>
<td align="right">36</td>
<td align="right">32</td>
<td align="right">32</td>
</tr>
<tr class="odd">
<td align="left">-</td>
<td align="left">+</td>
<td align="right">18</td>
<td align="right">19</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">+</td>
<td align="right">31</td>
<td align="right">30</td>
<td align="right">29</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelof22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span> <span class="op">+</span> <span class="va">A</span><span class="op">:</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">datosf22</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelof22</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: respuesta</span></span>
<span><span class="co">#&gt;           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; A          1 208.333 208.333 53.1915 8.444e-05 ***</span></span>
<span><span class="co">#&gt; B          1  75.000  75.000 19.1489  0.002362 ** </span></span>
<span><span class="co">#&gt; A:B        1   8.333   8.333  2.1277  0.182776    </span></span>
<span><span class="co">#&gt; Residuals  8  31.333   3.917                      </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lattice.r-forge.r-project.org/">lattice</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">trellis.par.set</a></span><span class="op">(</span>background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"A"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; NOTE: A is not a high-order term in the model</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"B"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; NOTE: B is not a high-order term in the model</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"A:B"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html">model.tables</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tables of effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  A </span></span>
<span><span class="co">#&gt; A</span></span>
<span><span class="co">#&gt;      -      + </span></span>
<span><span class="co">#&gt; -4.167  4.167 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  B </span></span>
<span><span class="co">#&gt; B</span></span>
<span><span class="co">#&gt;    -    + </span></span>
<span><span class="co">#&gt;  2.5 -2.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  A:B </span></span>
<span><span class="co">#&gt;    B</span></span>
<span><span class="co">#&gt; A   -       +      </span></span>
<span><span class="co">#&gt;   -  0.8333 -0.8333</span></span>
<span><span class="co">#&gt;   + -0.8333  0.8333</span></span></code></pre></div>
<div class="rmdejemplo">
<p>Vemos que los dos efectos principales son significativos, pero no lo es la interacción. Podemos eliminar ese término del modelo para así ganar grados de libertad y tener una mejor estimación del error.</p>
</div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelof22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">respuesta</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>, data <span class="op">=</span> <span class="va">datosf22</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelof22</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: respuesta</span></span>
<span><span class="co">#&gt;           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; A          1 208.333 208.333  47.269 7.265e-05 ***</span></span>
<span><span class="co">#&gt; B          1  75.000  75.000  17.017  0.002578 ** </span></span>
<span><span class="co">#&gt; Residuals  9  39.667   4.407                      </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"A"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"B"</span>, mod <span class="op">=</span> <span class="va">modelof22</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-10-1.png" width="672"></div>
</div>
<div id="diseño-factorial-23" class="section level3" number="11.8.2">
<h3>
<span class="header-section-number">11.8.2</span> Diseño factorial <span class="math inline">\(2^3\)</span><a class="anchor" aria-label="anchor" href="#dise%C3%B1o-factorial-23"><i class="fas fa-link"></i></a>
</h3>
<p>Modelo:</p>
<p><span class="math display">\[y_{ijkl} = \mu + \alpha_i + \beta_j + \gamma_k + \alpha\beta_{ij}
+ \alpha\gamma_{ik}+ \beta\gamma_{jk} + \alpha\beta\gamma_{ijk} + \varepsilon_{ijkl}\]</span></p>
<p>De forma similar al diseño <span class="math inline">\(2^2\)</span>, obtendríamos estimadores para los efectos principales y las interacciones. Si no tenemos réplicas, podemos omitir la interacción de orden 3 ya que rara vez es significativa, y así podremos estudiar los contrastes del resto de efectos.</p>
<div class="rmdejemplo">
<p>En el siguiente ejemplo, analizamos tres factores, pero omitimos la interacción de orden 3. Después, podríamos eliminar las interacciones menos significativas para quedarnos con el modelo más sencillo.</p>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datosf23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">-   -   -   60</span></span>
<span><span class="st">+   -   -   72  </span></span>
<span><span class="st">-   +   -   54</span></span>
<span><span class="st">+   +   -   68</span></span>
<span><span class="st">-   -   +   52</span></span>
<span><span class="st">+   -   +   83</span></span>
<span><span class="st">-   +   +   45</span></span>
<span><span class="st">+   +   +   80</span></span>
<span><span class="st">"</span>, </span>
<span>    what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span> </span>
<span><span class="va">datosf23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">datosf23</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">datosf23</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"C"</span>, <span class="st">"K"</span>, <span class="st">"rendimiento"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">datosf23</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">T</th>
<th align="left">C</th>
<th align="left">K</th>
<th align="right">rendimiento</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="right">72</td>
</tr>
<tr class="odd">
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="right">54</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="right">83</td>
</tr>
<tr class="odd">
<td align="left">-</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="right">45</td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="right">80</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelof23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rendimiento</span> <span class="op">~</span> <span class="cn">T</span> <span class="op">+</span> <span class="va">C</span> <span class="op">+</span> <span class="va">K</span> <span class="op">+</span> <span class="cn">T</span><span class="op">:</span><span class="va">C</span> <span class="op">+</span> <span class="cn">T</span><span class="op">:</span><span class="va">K</span> <span class="op">+</span> <span class="va">C</span><span class="op">:</span><span class="va">K</span>, data <span class="op">=</span> <span class="va">datosf23</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelof23</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: rendimiento</span></span>
<span><span class="co">#&gt;           Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; T          1 1058.0  1058.0    2116 0.01384 *</span></span>
<span><span class="co">#&gt; C          1   50.0    50.0     100 0.06345 .</span></span>
<span><span class="co">#&gt; K          1    4.5     4.5       9 0.20483  </span></span>
<span><span class="co">#&gt; T:C        1    4.5     4.5       9 0.20483  </span></span>
<span><span class="co">#&gt; T:K        1  200.0   200.0     400 0.03180 *</span></span>
<span><span class="co">#&gt; C:K        1    0.0     0.0       0 1.00000  </span></span>
<span><span class="co">#&gt; Residuals  1    0.5     0.5                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"T"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; NOTE: T is not a high-order term in the model</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-12-1.png" width="672"></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"C"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; NOTE: C is not a high-order term in the model</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-12-2.png" width="672"></div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"K"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; NOTE: K is not a high-order term in the model</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-12-3.png" width="672"></div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"T:C"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-12-4.png" width="672"></div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"T:K"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-12-5.png" width="672"></div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html">effect</a></span><span class="op">(</span>term <span class="op">=</span> <span class="st">"C:K"</span>, mod <span class="op">=</span> <span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-12-6.png" width="672"></div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html">model.tables</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">modelof23</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tables of effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  T </span></span>
<span><span class="co">#&gt; T</span></span>
<span><span class="co">#&gt;     -     + </span></span>
<span><span class="co">#&gt; -11.5  11.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  C </span></span>
<span><span class="co">#&gt; C</span></span>
<span><span class="co">#&gt;    -    + </span></span>
<span><span class="co">#&gt;  2.5 -2.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  K </span></span>
<span><span class="co">#&gt; K</span></span>
<span><span class="co">#&gt;     -     + </span></span>
<span><span class="co">#&gt; -0.75  0.75 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  T:C </span></span>
<span><span class="co">#&gt;    C</span></span>
<span><span class="co">#&gt; T   -     +    </span></span>
<span><span class="co">#&gt;   -  0.75 -0.75</span></span>
<span><span class="co">#&gt;   + -0.75  0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  T:K </span></span>
<span><span class="co">#&gt;    K</span></span>
<span><span class="co">#&gt; T   -  + </span></span>
<span><span class="co">#&gt;   -  5 -5</span></span>
<span><span class="co">#&gt;   + -5  5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  C:K </span></span>
<span><span class="co">#&gt;    K</span></span>
<span><span class="co">#&gt; C   -           +          </span></span>
<span><span class="co">#&gt;   - -1.0991e-15  1.0991e-15</span></span>
<span><span class="co">#&gt;   +  1.0991e-15 -1.0991e-15</span></span></code></pre></div>
</div>
<div id="diseño-factorial-2k" class="section level3" number="11.8.3">
<h3>
<span class="header-section-number">11.8.3</span> Diseño factorial <span class="math inline">\(2^k\)</span><a class="anchor" aria-label="anchor" href="#dise%C3%B1o-factorial-2k"><i class="fas fa-link"></i></a>
</h3>
<p>Siguiendo la misma estructura que los dos anteriores, con más efectos principales y más interacciones, pero más allá de 3 es muy difícil que se produzcan, y más difícil de interpretar.
El número de experimentos necesarios aumenta exponencialmente, y se suelen preferir experimentos fraccionados. Cuando no hay grados de libertad suficientes para realizar contrastes se utilizan herramientas gráficas para seleccionar efectos significativos, como el gráfico quantil-quantil de la distribución normal.</p>
<div class="rmdejemplo">
<p>El siguiente ejemplo aparece en <span class="citation">Lawson<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;em&gt;Design and Analysis of Experiments with r&lt;/em&gt;.&lt;/p&gt;"><sup>102</sup></a></span>. Se estudian 4 factores y no tenemos réplicas. Entonces, obtenemos estimadores pero no contrastes.</p>
</div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">daewr</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'DoE.base':</span></span>
<span><span class="co">#&gt;   method           from       </span></span>
<span><span class="co">#&gt;   factorize.factor conf.design</span></span>
<span><span class="va">modf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">A</span><span class="op">*</span><span class="va">B</span><span class="op">*</span><span class="va">C</span><span class="op">*</span><span class="va">D</span>, data <span class="op">=</span> <span class="va">chem</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modf</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ A * B * C * D, data = chem)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt; ALL 16 residuals are 0: no residual degrees of freedom!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)  62.3125        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A            -6.3125        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; B            17.8125        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; C             0.1875        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; D             0.6875        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A:B          -5.3125        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A:C           0.8125        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; B:C          -0.3125        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A:D           2.0625        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; B:D          -0.0625        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; C:D          -0.6875        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A:B:C        -0.1875        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A:B:D        -0.6875        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A:C:D         2.4375        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; B:C:D        -0.4375        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; A:B:C:D      -0.3125        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: NaN on 0 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:      1,  Adjusted R-squared:    NaN </span></span>
<span><span class="co">#&gt; F-statistic:   NaN on 15 and 0 DF,  p-value: NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/daewr/man/LGB.html">LGB</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">modf</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<pre><code>#&gt; Effect Report 
#&gt;    
#&gt; Label     Half Effect    Sig(.05) 
#&gt; A         -6.3125        yes        
#&gt; B         17.8125        yes        
#&gt; C          0.1875        no         
#&gt; D          0.6875        no         
#&gt; A:B       -5.3125        yes        
#&gt; A:C        0.8125        no         
#&gt; B:C       -0.3125        no         
#&gt; A:D        2.0625        no         
#&gt; B:D       -0.0625        no         
#&gt; C:D       -0.6875        no         
#&gt; A:B:C     -0.1875        no         
#&gt; A:B:D     -0.6875        no         
#&gt; A:C:D      2.4375        no         
#&gt; B:C:D     -0.4375        no         
#&gt; A:B:C:D   -0.3125        no         
#&gt;    
#&gt; Lawson, Grimshaw &amp; Burt Rn Statistic =  3.006953 
#&gt; 95th percentile of Rn =  1.201</code></pre>
<p>El método de Lenth se basa en un contraste de significación que puede encontrarse detallado en <span class="citation">Joseph Conklin<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;&lt;span&gt;“Design and Analysis of Experiments and Observational Studies Using r: By Nathan Taback, Boca Raton, FL: CRC Press, 2021, Xxii+ 270 Pp., 99.95hardcover, 89.95 eBook, ISBN 978-0367456856”&lt;/span&gt; (Taylor &amp;amp; Francis, 2022).&lt;/p&gt;"><sup>103</sup></a></span>. Se calcula un <em>margin of error</em> (ME). Los efectos más allá de ese margen serían significativos. Como se realizan muchos tests, algunos pueden ser identificados como significativos sin serlo. El <em>simultaneous margin of error</em> (SME) tiene en cuenta esta multiplicidad de contrastes.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/daewr/man/LenthPlot.html">LenthPlot</a></span><span class="op">(</span><span class="va">modf</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
<pre><code>#&gt;    alpha      PSE       ME      SME 
#&gt; 0.050000 1.687500 4.337857 8.806474</code></pre>
<div class="rmdpractica">
<p>A continuación se muestran algunas visualizaciones diferentes con el paquete {emmeans}. Primero reducimos el modelo a los efectos significativos</p>
</div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span></span>
<span><span class="va">modf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">chem</span><span class="op">)</span></span>
<span><span class="va">medias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">modf2</span>, <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">medias</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmip.html">emmip</a></span><span class="op">(</span><span class="va">modf2</span>, <span class="va">A</span><span class="op">~</span><span class="va">B</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-16-2.png" width="672"></div>
</div>
<div id="número-de-réplicas" class="section level3" number="11.8.4">
<h3>
<span class="header-section-number">11.8.4</span> Número de réplicas<a class="anchor" aria-label="anchor" href="#n%C3%BAmero-de-r%C3%A9plicas"><i class="fas fa-link"></i></a>
</h3>
<p>Wheeler (1974) estableció la siguiente fórmula aproximada para estimar el número total de unidades experimentales para conseguir una potencia del 95% en el experimento:</p>
<p><span class="math display">\[N = ((8\sigma)/\Delta)^2,\]</span></p>
<p>donde <span class="math inline">\(\sigma\)</span> es la desviación típica del error experimental, y <span class="math inline">\(\Delta\)</span> es el tamaño del efecto que consideraríamos significativo en la práctica. <span class="math inline">\(N\)</span> sería el número total de unidades experimentales, entonces el número de réplicas será <span class="math inline">\(N/2^k\)</span>.</p>
</div>
<div id="validación-del-modelo" class="section level3" number="11.8.5">
<h3>
<span class="header-section-number">11.8.5</span> Validación del modelo<a class="anchor" aria-label="anchor" href="#validaci%C3%B3n-del-modelo"><i class="fas fa-link"></i></a>
</h3>
<p>Los diseños factoriales son modelos lineales, y como tales deben cumplir:</p>
<ul>
<li>Normalidad de los residuos</li>
<li>Varianza constante</li>
</ul>
<p>Utilizamos las funciones <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> y <code><a href="https://rdrr.io/pkg/car/man/leveneTest.html">car::leveneTest()</a></code> respectivamente para verificarlas. También podemos obtener los gráficos de los residuos con la función <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modf2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  residuals(modf2)</span></span>
<span><span class="co">#&gt; W = 0.96544, p-value = 0.7604</span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">A</span><span class="op">*</span><span class="va">B</span>, data <span class="op">=</span> <span class="va">chem</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="va">factor</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = median)</span></span>
<span><span class="co">#&gt;       Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; group  3  0.2814 0.8379</span></span>
<span><span class="co">#&gt;       12</span></span></code></pre></div>
</div>
</div>
<div id="diseño-con-bloques" class="section level2" number="11.9">
<h2>
<span class="header-section-number">11.9</span> Diseño con bloques<a class="anchor" aria-label="anchor" href="#dise%C3%B1o-con-bloques"><i class="fas fa-link"></i></a>
</h2>
<p>Cuando hay algún factor más que no es de interés,
pero puede afectar a la variable respuesta, se debe introducir
como variable de bloque. Los diseños de cuadrados latinos
y cuadrados greco-latinos se utilizan para introducir dos o tres
factores de bloque respectivamente en diseños factoriales de un factor.</p>
<p>En los diseños factoriales <span class="math inline">\(2^k\)</span>, lo que se hace es “confundir” el efecto de alguna interacción de orden superior con el efecto del bloque.</p>
<p>Tomemos el ejemplo simulado de la matriz de diseño al inicio de este apartado. Los niveles de las interacciones se asignan multiplicando los signos de los niveles de cada tratamiento.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>AB <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span><span class="op">*</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">B</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span><span class="fl">0</span>, </span>
<span>                      <span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span>,</span>
<span>         AC <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span><span class="op">*</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">C</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span><span class="fl">0</span>, </span>
<span>                      <span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span>,</span>
<span>         BC <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">C</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span><span class="op">*</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">B</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span><span class="fl">0</span>, </span>
<span>                      <span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span>,</span>
<span>         ABC <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span><span class="op">*</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">B</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span><span class="op">*</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">C</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span><span class="fl">0</span>, </span>
<span>                      <span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">Orden estándar</th>
<th align="left">A</th>
<th align="left">B</th>
<th align="left">C</th>
<th align="left">AB</th>
<th align="left">AC</th>
<th align="left">BC</th>
<th align="left">ABC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">+</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">+</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">+</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
<td align="left">+</td>
</tr>
</tbody>
</table></div>
<p>En este caso, podríamos dividir el experimento en dos bloques: uno con las unidades experimentales que se corresponden con los tratamientos 1, 4, 6 y 7 (signo menos de la interacción ABC) y otro con los otros cuatro. De esta forma, el efecto del bloque queda “bloqueado”. El bloque puede ser cualquier circunstancia que pueda afectar a la respuesta pero que no nos interesa y normalmente no podemos controlar. Por ejemplo, si se trata de un proceso que requiere un horno, cada bandeja del horno puede dar resultados ligeramente distintos, pero lo que nos interesa es en cada bandeja cómo afectan los factores que sí controlamos.</p>
</div>
<div id="diseños-fraccionales" class="section level2" number="11.10">
<h2>
<span class="header-section-number">11.10</span> Diseños fraccionales<a class="anchor" aria-label="anchor" href="#dise%C3%B1os-fraccionales"><i class="fas fa-link"></i></a>
</h2>
<p>Los diseños factoriales fraccionales <span class="math inline">\(2^{k-p}\)</span> utilizan solo una fracción de su equivalente factorial. En estos diseños se confunden los efectos principales con las interacciones de mayor orden. De esta forma, se puede realizar <em>screening</em> de muchos factores con pocos experimentos, y una vez eliminados del modelo los efectos no significativos se estima mejor el error.</p>
</div>
<div id="otros-diseños" class="section level2" number="11.11">
<h2>
<span class="header-section-number">11.11</span> Otros diseños<a class="anchor" aria-label="anchor" href="#otros-dise%C3%B1os"><i class="fas fa-link"></i></a>
</h2>
<p>Existen otros diseños avanzados que no se tratan en este texto, como son:</p>
<ul>
<li>Plackett and Burman</li>
<li>Diseños anidados</li>
<li>Split-plot</li>
<li>Medidas repetidas</li>
</ul>
</div>
<div id="diseños-de-superficie-respuesta" class="section level2" number="11.12">
<h2>
<span class="header-section-number">11.12</span> Diseños de superficie respuesta<a class="anchor" aria-label="anchor" href="#dise%C3%B1os-de-superficie-respuesta"><i class="fas fa-link"></i></a>
</h2>
<p>En los experimentos de superficie respuesta, los factores en estudio son variables continuas. Es evidente que no podemos estudiar todos los niveles posibles de este tipo de factores, puesto que son infinitos. Sería inviable también realizar los experimentos con un alto número de niveles posibles desde el principio. Por eso, generalmente la metodología de superficie respuesta es realmente el último paso en un diseño experimental con factores continuos. Una secuenciación lógica para un experimento con muchos factores sería la siguiente:</p>
<ol style="list-style-type: decimal">
<li>Si existen datos históricos, realizar un estudio descriptivo para identificar relaciones.</li>
<li>Apoyarse también en la teoría para determinar posibles factores que afecten a la respuesta.</li>
<li>En una primera fase de <em>screening</em>, analizar muchos factores con diseños factoriales fraccionales.</li>
<li>Con lo aprendido de la fase de cribado, descartar los factores no significativos y estimar los efectos.</li>
<li>Aplicar la metodología de superficie respuesta:</li>
</ol>
<ul>
<li>Ampliar los niveles de los factores a estudiar.</li>
<li>Ajustar un modelo cuadrático.</li>
<li>Optimizar la ecuación del modelo cuadrático para obtener los valores óptimos de los parámetros.</li>
</ul>
<p>Con los modelos a dos niveles, elegiremos como mejor combinación de factores los extremos utilizados como niveles <code>-</code> y <code>+</code> de cada factor, es decir, en el <strong>perímetro</strong> del experimento. Esto será correcto cuando la relación sea lineal. Pero si la relación es “curvilínea”, entonces el óptimo puede estar fuera de los valores probados, que tendremos que buscar ajustando una función no lineal <span class="math inline">\(f\)</span>. Para el caso más simple de dos factores <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>:</p>
<p><span class="math display">\[y = f(x_1, x_2) + \varepsilon.\]</span></p>
<p>Esta función se puede aproximar por series de Taylor entorno al centro de la región de diseño, de forma que, en general para <span class="math inline">\(k\)</span> factores:</p>
<p><span class="math display">\[y = \beta_0+\sum\limits_{i=1}^k\beta_i X_i + \sum\limits_{i=1}^k\beta_{ii} X_i^2+\mathop{\sum^k\sum^k}_{i&lt;j}\beta_{ij} X_iX_j+\varepsilon.\]</span></p>
<p>En el diseño <span class="math inline">\(2^k\)</span>, los niveles serán el valor mínimo y el valor máximo elegidos para el experimento (que serán dos valores numéricos. Aquí, las variables <span class="math inline">\(X_i\)</span> estarán “escaladas” a -1 y 1 de la siguiente forma:</p>
<p><span class="math display">\[X_i = \frac{\text{Nivel factor}-\frac{\text{Nivel}_{+} + \text{Nivel}_{-}}{2}}{\frac{\text{Nivel}_{+} - \text{Nivel}_{-}}{2}}.\]</span></p>
<div class="rmdejemplo">
<p>Si tenemos un experimento con temperaturas fijadas en 10 y 20 grados centígrados:</p>
<p><span class="math display">\[X_{10}=\frac{10-\frac{10+20}{2}}{\frac{20-10}{2}}= \frac{-5}{5}= -1\]</span>
<span class="math display">\[X_{20}=\frac{20-\frac{10+20}{2}}{\frac{20-10}{2}}= \frac{5}{5}= +1\]</span></p>
</div>
<p>Esta <strong>forma cuadrática</strong> puede recoger una gran variedad de situaciones no lineales en la región de diseño. Ahora bien, son necesarios al menos tres puntos para recoger la curvatura. Entonces, si partimos de un diseño de cribado <span class="math inline">\(2^k\)</span> o <span class="math inline">\(2^{k-p}\)</span>, lo que haremos será ampliar el experimento tomando nuevos valores. Una técnica habitual es el diseño CCD (<em>Central Composite Design</em>). Para cada factor, se utilizan cinco niveles:</p>
<ol style="list-style-type: decimal">
<li>Los dos utilizados en el diseño <span class="math inline">\(2^k\)</span>.</li>
<li>Un punto central en cada factor <span class="math inline">\((X_i=0)\)</span>.</li>
<li>Dos puntos fuera de la región del diseño <span class="math inline">\(2^k\)</span>, o puntos axiales. En general, se toma el punto <span class="math inline">\(\alpha = \sqrt{k}\)</span> y el <span class="math inline">\(-\alpha\)</span>
</li>
</ol>
<p>El número de unidades experimentales adicionales puede ser muy grande si se identifican más de 3 factores determinantes. Para 3 factores, un CCD necesitará 19 unidades experimentales. O lo que es lo mismo, <span class="math inline">\(19-2^3 = 11\)</span> experimentos adicionales.</p>
<p>Antes de ampliar el experimento con nuevos puntos, se pueden hacer comprobaciones para ver si el modelo cuadrático es previsible que mejore el resultado. Si el modelo lineal es adecuado, los puntos axiales y centrales adicionales no serán necesarios. Esto se puede hacer con el paquete <code>rsm</code> de R.</p>
<div class="rmdejemplo">
<p>El conjunto de datos <code>cement</code> del paquete {daewr} contiene 20 mediciones de un experimento de superficie respuesta.</p>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">daewr</span><span class="op">)</span></span>
<span><span class="va">cement</span></span>
<span><span class="co">#&gt;       Block        x1        x2        x3     y</span></span>
<span><span class="co">#&gt; C1.1      1 -1.000000 -1.000000 -1.000000 109.5</span></span>
<span><span class="co">#&gt; C1.2      1  1.000000 -1.000000 -1.000000 117.0</span></span>
<span><span class="co">#&gt; C1.3      1 -1.000000  1.000000 -1.000000 110.5</span></span>
<span><span class="co">#&gt; C1.4      1  1.000000  1.000000 -1.000000 121.0</span></span>
<span><span class="co">#&gt; C1.5      1 -1.000000 -1.000000  1.000000 120.0</span></span>
<span><span class="co">#&gt; C1.6      1  1.000000 -1.000000  1.000000 130.0</span></span>
<span><span class="co">#&gt; C1.7      1 -1.000000  1.000000  1.000000 124.0</span></span>
<span><span class="co">#&gt; C1.8      1  1.000000  1.000000  1.000000 132.0</span></span>
<span><span class="co">#&gt; C1.9      1  0.000000  0.000000  0.000000 117.0</span></span>
<span><span class="co">#&gt; C1.10     1  0.000000  0.000000  0.000000 117.0</span></span>
<span><span class="co">#&gt; C1.11     1  0.000000  0.000000  0.000000 115.0</span></span>
<span><span class="co">#&gt; S2.1      2 -1.681793  0.000000  0.000000 109.5</span></span>
<span><span class="co">#&gt; S2.2      2  1.681793  0.000000  0.000000 132.0</span></span>
<span><span class="co">#&gt; S2.3      2  0.000000 -1.681793  0.000000 120.0</span></span>
<span><span class="co">#&gt; S2.4      2  0.000000  1.681793  0.000000 121.0</span></span>
<span><span class="co">#&gt; S2.5      2  0.000000  0.000000 -1.681793 115.0</span></span>
<span><span class="co">#&gt; S2.6      2  0.000000  0.000000  1.681793 127.0</span></span>
<span><span class="co">#&gt; S2.7      2  0.000000  0.000000  0.000000 116.0</span></span>
<span><span class="co">#&gt; S2.8      2  0.000000  0.000000  0.000000 117.0</span></span>
<span><span class="co">#&gt; S2.9      2  0.000000  0.000000  0.000000 117.0</span></span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rsm</span><span class="op">)</span></span>
<span><span class="va">grout.lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rsm/man/rsm.html">rsm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/rsm/man/FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">cement</span>, subset <span class="op">=</span> <span class="va">Block</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rsm(y ~ SO(x1, x2, x3), data = cement, subset = Block == 1): Some coefficients are aliased - cannot use 'rsm' methods.</span></span>
<span><span class="co">#&gt;   Returning an 'lm' object.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">grout.lin</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: y</span></span>
<span><span class="co">#&gt;                 Df Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; FO(x1, x2, x3)   3 465.13 155.042 80.3094 0.002307 **</span></span>
<span><span class="co">#&gt; TWI(x1, x2, x3)  3   0.25   0.083  0.0432 0.985889   </span></span>
<span><span class="co">#&gt; PQ(x1, x2, x3)   1  37.88  37.879 19.6207 0.021377 * </span></span>
<span><span class="co">#&gt; Residuals        3   5.79   1.931                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>En esta salida, la variabilidad se descompone en tres partes:</p>
<ul>
<li>FO: Los tres términos lineales simultáneamente</li>
<li>TWI: Los tres términos de interacción simultáneamente</li>
<li>PQ: Términos cuadráticos, es decir, si se aleja de la linealidad</li>
</ul>
<p>En el test F en el término PQ la hipótesis nula es que los datos se ajustan al modelo lineal. Como el p-valor es pequeño, se rechaza esta hipótesis y el modelo cuadrático es más adecuado. Entonces concluiríamos que es necesario completar el experimento con los puntos axiales.</p>
<p>Una vez se ajusta un modelo de superficie respuesta con los datos de un experimento, querremos determinar los valores óptimos de los factores. La forma más sencilla es mediante gráficos de contorno (o curvas de nivel) para cada para de factores. Métodos más precisos de optimización nos darán valores numéricos.</p>
<div class="rmdejemplo">
<p>El conjunto de datos <code>Treb</code> del paquete {daewr} contiene datos experimentales de un fundíbulo (arma medieval de asedio) en el que se mide la distancia dependiendo de tres factores: longitud del brazo (A), contrapeso (B) y peso del proyectil (C). En este caso se ha realizado un diseño de Box-Behnken. El punto estacionario sería un candidato a ser el óptimo. No obstante hay que comprobar si está en la región de diseño (y si es un máximo o un mínimo). El método ridge buscará el máximo en un radio determinado (hasta cubrir la región de diseño).</p>
</div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Treb</span></span>
<span><span class="co">#&gt;    A  B   C   y</span></span>
<span><span class="co">#&gt; 1  4 10 2.5  33</span></span>
<span><span class="co">#&gt; 2  8 10 2.5  85</span></span>
<span><span class="co">#&gt; 3  4 20 2.5  86</span></span>
<span><span class="co">#&gt; 4  8 20 2.5 113</span></span>
<span><span class="co">#&gt; 5  4 15 2.0  75</span></span>
<span><span class="co">#&gt; 6  8 15 2.0 105</span></span>
<span><span class="co">#&gt; 7  4 15 3.0  40</span></span>
<span><span class="co">#&gt; 8  8 15 3.0  89</span></span>
<span><span class="co">#&gt; 9  6 10 2.0  83</span></span>
<span><span class="co">#&gt; 10 6 20 2.0 108</span></span>
<span><span class="co">#&gt; 11 6 10 3.0  49</span></span>
<span><span class="co">#&gt; 12 6 20 3.0 101</span></span>
<span><span class="co">#&gt; 13 6 15 2.5  88</span></span>
<span><span class="co">#&gt; 14 6 15 2.5  91</span></span>
<span><span class="co">#&gt; 15 6 15 2.5  91</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data are stored in coded form using these coding formulas ...</span></span>
<span><span class="co">#&gt; x1 ~ (A - 6)/2</span></span>
<span><span class="co">#&gt; x2 ~ (B - 15)/5</span></span>
<span><span class="co">#&gt; x3 ~ (C - 2.5)/0.5</span></span>
<span><span class="va">treb.quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rsm/man/rsm.html">rsm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/rsm/man/FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Treb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">treb.quad</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; rsm(formula = y ~ SO(x1, x2, x3), data = Treb)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  90.00000    1.16905  76.9859 7.006e-09 ***</span></span>
<span><span class="co">#&gt; x1           19.75000    0.71589  27.5880 1.171e-06 ***</span></span>
<span><span class="co">#&gt; x2           19.75000    0.71589  27.5880 1.171e-06 ***</span></span>
<span><span class="co">#&gt; x3          -11.50000    0.71589 -16.0639 1.703e-05 ***</span></span>
<span><span class="co">#&gt; x1:x2        -6.25000    1.01242  -6.1733 0.0016247 ** </span></span>
<span><span class="co">#&gt; x1:x3         4.75000    1.01242   4.6917 0.0053768 ** </span></span>
<span><span class="co">#&gt; x2:x3         6.75000    1.01242   6.6672 0.0011461 ** </span></span>
<span><span class="co">#&gt; x1^2         -9.37500    1.05376  -8.8967 0.0002986 ***</span></span>
<span><span class="co">#&gt; x2^2         -1.37500    1.05376  -1.3048 0.2487686    </span></span>
<span><span class="co">#&gt; x3^2         -3.37500    1.05376  -3.2028 0.0239200 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9975, Adjusted R-squared:  0.9929 </span></span>
<span><span class="co">#&gt; F-statistic: 218.9 on 9 and 5 DF,  p-value: 5.964e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: y</span></span>
<span><span class="co">#&gt;                 Df Sum Sq Mean Sq  F value    Pr(&gt;F)</span></span>
<span><span class="co">#&gt; FO(x1, x2, x3)   3 7299.0 2433.00 593.4146 8.448e-07</span></span>
<span><span class="co">#&gt; TWI(x1, x2, x3)  3  428.8  142.92  34.8577 0.0008912</span></span>
<span><span class="co">#&gt; PQ(x1, x2, x3)   3  351.5  117.16  28.5759 0.0014236</span></span>
<span><span class="co">#&gt; Residuals        5   20.5    4.10                   </span></span>
<span><span class="co">#&gt; Lack of fit      3   14.5    4.83   1.6111 0.4051312</span></span>
<span><span class="co">#&gt; Pure error       2    6.0    3.00                   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Stationary point of response surface:</span></span>
<span><span class="co">#&gt;         x1         x2         x3 </span></span>
<span><span class="co">#&gt;  0.9236846 -1.7161183 -2.7698217 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Stationary point in original units:</span></span>
<span><span class="co">#&gt;        A        B        C </span></span>
<span><span class="co">#&gt; 7.847369 6.419409 1.115089 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenanalysis:</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1]   1.280298  -3.551452 -11.853845</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;          [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt; x1 -0.1236692  0.5238084  0.8428112</span></span>
<span><span class="co">#&gt; x2  0.8323200 -0.4077092  0.3755217</span></span>
<span><span class="co">#&gt; x3  0.5403233  0.7479291 -0.3855551</span></span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">treb.quad</span>, <span class="op">~</span> <span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-21-1.png" width="672"></div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">treb.quad</span>, <span class="op">~</span> <span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rsm/man/rsm.html">xs</a></span><span class="op">(</span><span class="va">treb.quad</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-22-1.png" width="672"></div>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/persp.html">persp</a></span><span class="op">(</span><span class="va">treb.quad</span>, <span class="op">~</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span>, zlab <span class="op">=</span> <span class="st">"Distancia"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-doe_files/figure-html/unnamed-chunk-23-1.png" width="672"></div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rsm/man/steepest.html">steepest</a></span><span class="op">(</span><span class="va">treb.quad</span>, dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.412</span>, by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>, descent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Path of steepest ascent from ridge analysis:</span></span>
<span><span class="va">ridge</span></span>
<span><span class="co">#&gt;    dist    x1    x2     x3 |     A      B      C |    yhat</span></span>
<span><span class="co">#&gt; 1   0.0 0.000 0.000  0.000 | 6.000 15.000 2.5000 |  90.000</span></span>
<span><span class="co">#&gt; 2   0.1 0.064 0.067 -0.037 | 6.128 15.335 2.4815 |  92.909</span></span>
<span><span class="co">#&gt; 3   0.2 0.124 0.139 -0.073 | 6.248 15.695 2.4635 |  95.626</span></span>
<span><span class="co">#&gt; 4   0.3 0.180 0.215 -0.105 | 6.360 16.075 2.4475 |  98.120</span></span>
<span><span class="co">#&gt; 5   0.4 0.232 0.297 -0.134 | 6.464 16.485 2.4330 | 100.455</span></span>
<span><span class="co">#&gt; 6   0.5 0.277 0.385 -0.158 | 6.554 16.925 2.4210 | 102.599</span></span>
<span><span class="co">#&gt; 7   0.6 0.315 0.480 -0.175 | 6.630 17.400 2.4125 | 104.590</span></span>
<span><span class="co">#&gt; 8   0.7 0.345 0.580 -0.185 | 6.690 17.900 2.4075 | 106.424</span></span>
<span><span class="co">#&gt; 9   0.8 0.368 0.686 -0.185 | 6.736 18.430 2.4075 | 108.154</span></span>
<span><span class="co">#&gt; 10  0.9 0.384 0.795 -0.177 | 6.768 18.975 2.4115 | 109.783</span></span>
<span><span class="co">#&gt; 11  1.0 0.393 0.905 -0.161 | 6.786 19.525 2.4195 | 111.318</span></span>
<span><span class="co">#&gt; 12  1.1 0.397 1.017 -0.137 | 6.794 20.085 2.4315 | 112.817</span></span>
<span><span class="co">#&gt; 13  1.2 0.398 1.127 -0.107 | 6.796 20.635 2.4465 | 114.259</span></span>
<span><span class="co">#&gt; 14  1.3 0.395 1.236 -0.073 | 6.790 21.180 2.4635 | 115.673</span></span>
<span><span class="co">#&gt; 15  1.4 0.390 1.344 -0.034 | 6.780 21.720 2.4830 | 117.077</span></span></code></pre></div>
<p>Una última opción sería la optimización no lineal de la ecuación de regresión.</p>
<p>Los diseños de superficie respuesta también se pueden plantear sin fase de screening, si se tienen muy claros los factores a estudiar.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">daewr</span><span class="op">)</span></span>
<span><span class="va">Design</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/daewr/man/DefScreen.html">DefScreen</a></span><span class="op">(</span>m<span class="op">=</span><span class="fl">8</span>,c<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">Design</span></span>
<span><span class="co">#&gt;     A  B  C  D  E  F  G  H</span></span>
<span><span class="co">#&gt; 1   0 -1  1  1 -1  1  1  1</span></span>
<span><span class="co">#&gt; 2   0  1 -1 -1  1 -1 -1 -1</span></span>
<span><span class="co">#&gt; 3  -1  0 -1  1  1  1  1 -1</span></span>
<span><span class="co">#&gt; 4   1  0  1 -1 -1 -1 -1  1</span></span>
<span><span class="co">#&gt; 5  -1 -1  0  1  1 -1 -1  1</span></span>
<span><span class="co">#&gt; 6   1  1  0 -1 -1  1  1 -1</span></span>
<span><span class="co">#&gt; 7   1 -1  1  0  1  1 -1 -1</span></span>
<span><span class="co">#&gt; 8  -1  1 -1  0 -1 -1  1  1</span></span>
<span><span class="co">#&gt; 9  -1 -1  1 -1  0 -1  1 -1</span></span>
<span><span class="co">#&gt; 10  1  1 -1  1  0  1 -1  1</span></span>
<span><span class="co">#&gt; 11  1 -1 -1 -1  1  0  1  1</span></span>
<span><span class="co">#&gt; 12 -1  1  1  1 -1  0 -1 -1</span></span>
<span><span class="co">#&gt; 13 -1  1  1 -1  1  1  0  1</span></span>
<span><span class="co">#&gt; 14  1 -1 -1  1 -1 -1  0 -1</span></span>
<span><span class="co">#&gt; 15  1  1  1  1  1 -1  1  0</span></span>
<span><span class="co">#&gt; 16 -1 -1 -1 -1 -1  1 -1  0</span></span>
<span><span class="co">#&gt; 17  0  0  0  0  0  0  0  0</span></span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">daewr</span><span class="op">)</span></span>
<span><span class="va">design</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/daewr/man/DefScreen.html">DefScreen</a></span><span class="op">(</span>m<span class="op">=</span><span class="fl">5</span>,c<span class="op">=</span><span class="fl">0</span>,center<span class="op">=</span><span class="fl">2</span>,randomize<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">design</span></span>
<span><span class="co">#&gt;     A  B  C  D  E</span></span>
<span><span class="co">#&gt; 1   0  1  1 -1 -1</span></span>
<span><span class="co">#&gt; 2   0 -1 -1  1  1</span></span>
<span><span class="co">#&gt; 3   1  0 -1 -1  1</span></span>
<span><span class="co">#&gt; 4  -1  0  1  1 -1</span></span>
<span><span class="co">#&gt; 5   1 -1  0  1 -1</span></span>
<span><span class="co">#&gt; 6  -1  1  0 -1  1</span></span>
<span><span class="co">#&gt; 7   1 -1  1  0  1</span></span>
<span><span class="co">#&gt; 8  -1  1 -1  0 -1</span></span>
<span><span class="co">#&gt; 9   1  1  1  1  0</span></span>
<span><span class="co">#&gt; 10 -1 -1 -1 -1  0</span></span>
<span><span class="co">#&gt; 11  0  0  0  0  0</span></span>
<span><span class="co">#&gt; 12  0  0  0  0  0</span></span>
<span><span class="co">#&gt; 13  0  0  0  0  0</span></span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">daewr</span><span class="op">)</span></span>
<span><span class="va">Smeso</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">241</span>,<span class="fl">295</span>,<span class="fl">260</span>,<span class="fl">338</span>,<span class="fl">320</span>,<span class="fl">265</span>,<span class="fl">275</span>,<span class="fl">248</span>,<span class="fl">92.5</span>,<span class="fl">383</span>,<span class="fl">313</span>,<span class="fl">305</span>,<span class="fl">304</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/daewr/man/FitDefSc.html">FitDefSc</a></span><span class="op">(</span><span class="va">Smeso</span>,<span class="va">design</span>,alpha<span class="op">=</span><span class="fl">.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ (.), data = ndesign)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.667  -3.653   0.000   3.550  12.373 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  304.000      5.012  60.656 1.35e-09 ***</span></span>
<span><span class="co">#&gt; B            -76.030      4.362 -17.429 2.29e-06 ***</span></span>
<span><span class="co">#&gt; D            -26.609      4.533  -5.870 0.001082 ** </span></span>
<span><span class="co">#&gt; B:D          -21.023      4.779  -4.399 0.004572 ** </span></span>
<span><span class="co">#&gt; I(B^2)       -44.318      6.500  -6.819 0.000488 ***</span></span>
<span><span class="co">#&gt; A            -42.803      4.362  -9.812 6.45e-05 ***</span></span>
<span><span class="co">#&gt; E            -21.459      4.533  -4.734 0.003213 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 11.21 on 6 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9866, Adjusted R-squared:  0.9733 </span></span>
<span><span class="co">#&gt; F-statistic:  73.9 on 6 and 6 DF,  p-value: 2.333e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Sums of Squares  df F-value P-value</span></span>
<span><span class="co">#&gt; Lack of Fit       704.89318   4 7.24205 0.04059</span></span>
<span><span class="co">#&gt; Pure Error         48.66667   2</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">daewr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/daewr/man/FitDefSc.html">FitDefSc</a></span><span class="op">(</span><span class="va">Smeso</span>,<span class="va">design</span>,alpha<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ (.), data = ndesign)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;        1        2        3        4        5        6 </span></span>
<span><span class="co">#&gt; -0.39670 -2.32094  0.46480  3.15873 -0.12433  1.03021 </span></span>
<span><span class="co">#&gt;        7        8        9       10       11       12 </span></span>
<span><span class="co">#&gt;  3.54358  0.07995 -0.71346 -1.09831  4.45882 -3.54118 </span></span>
<span><span class="co">#&gt;       13 </span></span>
<span><span class="co">#&gt; -4.54118 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  308.541      2.386 129.329 2.14e-08 ***</span></span>
<span><span class="co">#&gt; I(D^2)       -11.353      3.046  -3.727 0.020353 *  </span></span>
<span><span class="co">#&gt; D            -26.609      1.855 -14.343 0.000137 ***</span></span>
<span><span class="co">#&gt; B            -76.030      1.785 -42.589 1.82e-06 ***</span></span>
<span><span class="co">#&gt; E            -21.459      1.855 -11.567 0.000319 ***</span></span>
<span><span class="co">#&gt; B:E           11.344      2.125   5.338 0.005933 ** </span></span>
<span><span class="co">#&gt; B:D          -21.024      1.974 -10.649 0.000440 ***</span></span>
<span><span class="co">#&gt; I(B^2)       -37.509      2.974 -12.611 0.000228 ***</span></span>
<span><span class="co">#&gt; A            -42.803      1.785 -23.976 1.79e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.586 on 4 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9985, Adjusted R-squared:  0.9955 </span></span>
<span><span class="co">#&gt; F-statistic: 334.9 on 8 and 4 DF,  p-value: 2.216e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Sums of Squares  df F-value P-value</span></span>
<span><span class="co">#&gt; Lack of Fit        35.46992   2 0.72883 0.57842</span></span>
<span><span class="co">#&gt; Pure Error         48.66667   2</span></span></code></pre></div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="anova.html"><span class="header-section-number">10</span> Análisis de la Varianza</a></div>
<div class="next"><a href="regresion.html"><span class="header-section-number">12</span> Modelos de regresión</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice capítulo"><h2>Índice capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#doe"><span class="header-section-number">11</span> Diseño de experimentos</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n-4"><span class="header-section-number">11.1</span> Introducción</a></li>
<li><a class="nav-link" href="#bases-del-doe-origen-importancia-objetivos-y-requerimientos"><span class="header-section-number">11.2</span> Bases del DoE: origen, importancia, objetivos y requerimientos</a></li>
<li><a class="nav-link" href="#doe.importancia"><span class="header-section-number">11.3</span> Importancia del diseño</a></li>
<li><a class="nav-link" href="#planificaci%C3%B3n-de-la-experimentaci%C3%B3n"><span class="header-section-number">11.4</span> Planificación de la experimentación</a></li>
<li><a class="nav-link" href="#tipos-de-dise%C3%B1os-de-experimentos"><span class="header-section-number">11.5</span> Tipos de diseños de experimentos</a></li>
<li><a class="nav-link" href="#experimentos-con-un-factor-crd"><span class="header-section-number">11.6</span> Experimentos con un factor (CRD)</a></li>
<li><a class="nav-link" href="#dise%C3%B1os-factoriales-crfd"><span class="header-section-number">11.7</span> Diseños factoriales (CRFD)</a></li>
<li>
<a class="nav-link" href="#dise%C3%B1os-factoriales-a-dos-niveles-2k"><span class="header-section-number">11.8</span> Diseños factoriales a dos niveles \(2^k\)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dise%C3%B1o-factorial-22"><span class="header-section-number">11.8.1</span> Diseño factorial \(2^2\)</a></li>
<li><a class="nav-link" href="#dise%C3%B1o-factorial-23"><span class="header-section-number">11.8.2</span> Diseño factorial \(2^3\)</a></li>
<li><a class="nav-link" href="#dise%C3%B1o-factorial-2k"><span class="header-section-number">11.8.3</span> Diseño factorial \(2^k\)</a></li>
<li><a class="nav-link" href="#n%C3%BAmero-de-r%C3%A9plicas"><span class="header-section-number">11.8.4</span> Número de réplicas</a></li>
<li><a class="nav-link" href="#validaci%C3%B3n-del-modelo"><span class="header-section-number">11.8.5</span> Validación del modelo</a></li>
</ul>
</li>
<li><a class="nav-link" href="#dise%C3%B1o-con-bloques"><span class="header-section-number">11.9</span> Diseño con bloques</a></li>
<li><a class="nav-link" href="#dise%C3%B1os-fraccionales"><span class="header-section-number">11.10</span> Diseños fraccionales</a></li>
<li><a class="nav-link" href="#otros-dise%C3%B1os"><span class="header-section-number">11.11</span> Otros diseños</a></li>
<li><a class="nav-link" href="#dise%C3%B1os-de-superficie-respuesta"><span class="header-section-number">11.12</span> Diseños de superficie respuesta</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/emilopezcano/estadistica-ciencias-ingenieria/blob/master/11-doe.Rmd">Ver fuente <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/emilopezcano/estadistica-ciencias-ingenieria/edit/master/11-doe.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Estadística Aplicada a las Ciencias y la Ingeniería</strong>" escrito por <a href="http://emilio.lcano.com" class="text-light">Emilio L. Cano</a>. Generado por última vez el día 2023-04-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
